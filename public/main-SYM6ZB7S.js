import{$ as cc,A as Zn,B as hi,Ba as _f,C as le,D as he,E as er,F as Tn,G as bn,H as Kt,I as di,J as of,K as F,L as j,M as fi,N as tr,O as Qe,P as ce,Q as af,R as B,S as ac,T as P,U as S,V as ue,W as xe,X as Oe,Y as Ee,Z as K,_ as ne,a as $e,aa as cf,b as He,ba as N,c as Wt,ca as nr,d as y,da as it,e as ui,ea as pi,f as Zd,fa as mi,g as ef,ga as gi,h as tf,ha as ht,i as nf,ia as ge,j as rc,ja as uc,k as ic,ka as uf,l as sc,la as lf,m as oc,ma as hf,n as li,na as df,o as rf,oa as lc,p as sf,pa as rr,q as Ns,qa as St,r as ut,ra as hc,s as lt,sa as ir,t as ks,ta as Qt,u as Ke,ua as dt,v as Ht,va as ff,w as Ze,wa as pf,x as me,xa as mf,y as Vs,ya as sr,z as be,za as gf}from"./chunk-THRXIHL3.js";var vf=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},hy=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],u=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},If={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,u=a?n[i+1]:0,l=i+2<n.length,d=l?n[i+2]:0,p=s>>2,v=(s&3)<<4|u>>4,b=(u&15)<<2|d>>6,R=d&63;l||(R=64,a||(b=64)),r.push(t[p],t[v],t[b],t[R])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):hy(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let v=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||v==null)throw new fc;let b=s<<2|u>>4;if(r.push(b),d!==64){let R=u<<4&240|d>>2;if(r.push(R),v!==64){let x=d<<6&192|v;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},fc=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},dy=function(n){let e=vf(n);return If.encodeByteArray(e,!0)},_i=function(n){return dy(n).replace(/\./g,"")},mc=function(n){try{return If.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function fy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var py=()=>fy().__FIREBASE_DEFAULTS__,my=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},gy=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&mc(n[1]);return e&&JSON.parse(e)},Os=()=>{try{return py()||my()||gy()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},gc=n=>{var e,t;return(t=(e=Os())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Ef=n=>{let e=gc(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},_c=()=>{var n;return(n=Os())===null||n===void 0?void 0:n.config},yc=n=>{var e;return(e=Os())===null||e===void 0?void 0:e[`_${n}`]};var xs=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function wf(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[_i(JSON.stringify(t)),_i(JSON.stringify(a)),""].join(".")}function Ae(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Tf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ae())}function _y(){var n;let e=(n=Os())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bf(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Af(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Cf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Sf(){let n=Ae();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Rf(){return!_y()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vc(){try{return typeof indexedDB=="object"}catch{return!1}}function Pf(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var yy="FirebaseError",Je=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=yy,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Rt.prototype.create)}},Rt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?vy(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Je(i,u,r)}};function vy(n,e){return n.replace(Iy,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Iy=/\{\$([^}]+)}/g;function Df(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function An(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(yf(s)&&yf(a)){if(!An(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function yf(n){return n!==null&&typeof n=="object"}function yi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function or(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function ar(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Nf(n,e){let t=new pc(n,e);return t.subscribe.bind(t)}var pc=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Ey(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=dc),i.error===void 0&&(i.error=dc),i.complete===void 0&&(i.complete=dc);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Ey(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function dc(){}var Lb=4*60*60*1e3;function we(n){return n&&n._delegate?n._delegate:n}var et=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Cn="[DEFAULT]";var Ic=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new xs;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ty(e))try{this.getOrInitializeService({instanceIdentifier:Cn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Cn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Cn){return this.instances.has(e)}getOptions(e=Cn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wy(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Cn){return this.component?this.component.multipleInstances?e:Cn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function wy(n){return n===Cn?void 0:n}function Ty(n){return n.instantiationMode==="EAGER"}var Ms=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Ic(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var by=[],Q=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Q||{}),Ay={debug:Q.DEBUG,verbose:Q.VERBOSE,info:Q.INFO,warn:Q.WARN,error:Q.ERROR,silent:Q.SILENT},Cy=Q.INFO,Sy={[Q.DEBUG]:"log",[Q.VERBOSE]:"log",[Q.INFO]:"info",[Q.WARN]:"warn",[Q.ERROR]:"error"},Ry=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Sy[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Jt=class{constructor(e){this.name=e,this._logLevel=Cy,this._logHandler=Ry,this._userLogHandler=null,by.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ay[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Q.DEBUG,...e),this._logHandler(this,Q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Q.VERBOSE,...e),this._logHandler(this,Q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Q.INFO,...e),this._logHandler(this,Q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Q.WARN,...e),this._logHandler(this,Q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Q.ERROR,...e),this._logHandler(this,Q.ERROR,...e)}};var Py=(n,e)=>e.some(t=>n instanceof t),kf,Vf;function Dy(){return kf||(kf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ny(){return Vf||(Vf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var xf=new WeakMap,wc=new WeakMap,Of=new WeakMap,Ec=new WeakMap,bc=new WeakMap;function ky(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(ft(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&xf.set(t,n)}).catch(()=>{}),bc.set(e,n),e}function Vy(n){if(wc.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});wc.set(n,e)}var Tc={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return wc.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Of.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ft(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Mf(n){Tc=n(Tc)}function xy(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Fs(this),e,...t);return Of.set(r,e.sort?e.sort():[e]),ft(r)}:Ny().includes(n)?function(...e){return n.apply(Fs(this),e),ft(xf.get(this))}:function(...e){return ft(n.apply(Fs(this),e))}}function Oy(n){return typeof n=="function"?xy(n):(n instanceof IDBTransaction&&Vy(n),Py(n,Dy())?new Proxy(n,Tc):n)}function ft(n){if(n instanceof IDBRequest)return ky(n);if(Ec.has(n))return Ec.get(n);let e=Oy(n);return e!==n&&(Ec.set(n,e),bc.set(e,n)),e}var Fs=n=>bc.get(n);function Lf(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),u=ft(a);return r&&a.addEventListener("upgradeneeded",l=>{r(ft(a.result),l.oldVersion,l.newVersion,ft(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var My=["get","getKey","getAll","getAllKeys","count"],Fy=["put","add","delete","clear"],Ac=new Map;function Ff(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ac.get(e))return Ac.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Fy.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||My.includes(t)))return;let s=function(a,...u){return y(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),d=l.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&l.done]))[0]})};return Ac.set(e,s),s}Mf(n=>He($e({},n),{get:(e,t,r)=>Ff(e,t)||n.get(e,t,r),has:(e,t)=>!!Ff(e,t)||n.has(e,t)}));var Sc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Ly(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Ly(n){let e=n.getComponent();return e?.type==="VERSION"}var Rc="@firebase/app",Uf="0.10.13";var Pt=new Jt("@firebase/app"),Uy="@firebase/app-compat",By="@firebase/analytics-compat",qy="@firebase/analytics",jy="@firebase/app-check-compat",$y="@firebase/app-check",Gy="@firebase/auth",zy="@firebase/auth-compat",Wy="@firebase/database",Hy="@firebase/data-connect",Ky="@firebase/database-compat",Qy="@firebase/functions",Jy="@firebase/functions-compat",Yy="@firebase/installations",Xy="@firebase/installations-compat",Zy="@firebase/messaging",ev="@firebase/messaging-compat",tv="@firebase/performance",nv="@firebase/performance-compat",rv="@firebase/remote-config",iv="@firebase/remote-config-compat",sv="@firebase/storage",ov="@firebase/storage-compat",av="@firebase/firestore",cv="@firebase/vertexai-preview",uv="@firebase/firestore-compat",lv="firebase",hv="10.14.1";var Pc="[DEFAULT]",dv={[Rc]:"fire-core",[Uy]:"fire-core-compat",[qy]:"fire-analytics",[By]:"fire-analytics-compat",[$y]:"fire-app-check",[jy]:"fire-app-check-compat",[Gy]:"fire-auth",[zy]:"fire-auth-compat",[Wy]:"fire-rtdb",[Hy]:"fire-data-connect",[Ky]:"fire-rtdb-compat",[Qy]:"fire-fn",[Jy]:"fire-fn-compat",[Yy]:"fire-iid",[Xy]:"fire-iid-compat",[Zy]:"fire-fcm",[ev]:"fire-fcm-compat",[tv]:"fire-perf",[nv]:"fire-perf-compat",[rv]:"fire-rc",[iv]:"fire-rc-compat",[sv]:"fire-gcs",[ov]:"fire-gcs-compat",[av]:"fire-fst",[uv]:"fire-fst-compat",[cv]:"fire-vertex","fire-js":"fire-js",[lv]:"fire-js-all"};var vi=new Map,fv=new Map,Dc=new Map;function Bf(n,e){try{n.container.addComponent(e)}catch(t){Pt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Xt(n){let e=n.name;if(Dc.has(e))return Pt.debug(`There were multiple attempts to register component ${e}.`),!1;Dc.set(e,n);for(let t of vi.values())Bf(t,n);for(let t of fv.values())Bf(t,n);return!0}function Ei(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function st(n){return n.settings!==void 0}var pv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yt=new Rt("app","Firebase",pv);var Nc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new et("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yt.create("app-deleted",{appName:this._name})}};var Zt=hv;function xc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Pc,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Yt.create("bad-app-name",{appName:String(i)});if(t||(t=_c()),!t)throw Yt.create("no-options");let s=vi.get(i);if(s){if(An(t,s.options)&&An(r,s.config))return s;throw Yt.create("duplicate-app",{appName:i})}let a=new Ms(i);for(let l of Dc.values())a.addComponent(l);let u=new Nc(t,r,a);return vi.set(i,u),u}function cr(n=Pc){let e=vi.get(n);if(!e&&n===Pc&&_c())return xc();if(!e)throw Yt.create("no-app",{appName:n});return e}function Ls(){return Array.from(vi.values())}function Te(n,e,t){var r;let i=(r=dv[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pt.warn(u.join(" "));return}Xt(new et(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var mv="firebase-heartbeat-database",gv=1,Ii="firebase-heartbeat-store",Cc=null;function Gf(){return Cc||(Cc=Lf(mv,gv,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ii)}catch(t){console.warn(t)}}}}).catch(n=>{throw Yt.create("idb-open",{originalErrorMessage:n.message})})),Cc}function _v(n){return y(this,null,function*(){try{let t=(yield Gf()).transaction(Ii),r=yield t.objectStore(Ii).get(zf(n));return yield t.done,r}catch(e){if(e instanceof Je)Pt.warn(e.message);else{let t=Yt.create("idb-get",{originalErrorMessage:e?.message});Pt.warn(t.message)}}})}function qf(n,e){return y(this,null,function*(){try{let r=(yield Gf()).transaction(Ii,"readwrite");yield r.objectStore(Ii).put(e,zf(n)),yield r.done}catch(t){if(t instanceof Je)Pt.warn(t.message);else{let r=Yt.create("idb-set",{originalErrorMessage:t?.message});Pt.warn(r.message)}}})}function zf(n){return`${n.name}!${n.options.appId}`}var yv=1024,vv=30*24*60*60*1e3,kc=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Vc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=jf();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=vv}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Pt.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=jf(),{heartbeatsToSend:r,unsentEntries:i}=Iv(this._heartbeatsCache.heartbeats),s=_i(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Pt.warn(t),""}})}};function jf(){return new Date().toISOString().substring(0,10)}function Iv(n,e=yv){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),$f(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),$f(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Vc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return vc()?Pf().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield _v(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return qf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return qf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function $f(n){return _i(JSON.stringify({version:2,heartbeats:n})).length}function Ev(n){Xt(new et("platform-logger",e=>new Sc(e),"PRIVATE")),Xt(new et("heartbeat",e=>new kc(e),"PRIVATE")),Te(Rc,Uf,n),Te(Rc,Uf,"esm2017"),Te("fire-js","")}Ev("");var wv="firebase",Tv="10.14.1";Te(wv,Tv,"app");var Rn=new uc("ANGULARFIRE2_VERSION");function Bs(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var wi=(n,e)=>{let t=e?[e]:Ls(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},lr=class{constructor(){return wi(bv)}},bv="app-check";function ur(){}var Us=class{zone;delegate;constructor(e,t=nf){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,r)}},Oc=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ur,{},ur,ur)),t.pipe(sf({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},hr=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Us(Zone.current)),this.insideAngular=t.run(()=>new Us(Zone.current,tf)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Ht(Kt))};static \u0275prov=lt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qs(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Av(n){return qs().ngZone.runOutsideAngular(()=>n())}function Sn(n){return qs().ngZone.run(()=>n())}function Cv(n){return Sv(qs())(n)}function Sv(n){return function(t){return t=t.lift(new Oc(n.ngZone)),t.pipe(sc(n.outsideAngular),ic(n.insideAngular))}}var Rv=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Sn(()=>n.apply(void 0,r))},tt=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Sn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ur,{},ur,ur))),r[s]=Rv(r[s],t));let i=Av(()=>n.apply(this,r));if(!e)if(i instanceof ui){let s=qs();return i.pipe(sc(s.outsideAngular),ic(s.insideAngular))}else return Sn(()=>i);return i instanceof ui?i.pipe(Cv):i instanceof Promise?Sn(()=>new Promise((s,a)=>i.then(u=>Sn(()=>s(u)),u=>Sn(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Sn(()=>i)};var Dt=class{constructor(e){return e}},Pn=class{constructor(){return Ls()}};function Pv(n){return n&&n.length===1?n[0]:new Dt(cr())}var Mc=new Ke("angularfire2._apps"),Dv={provide:Dt,useFactory:Pv,deps:[[new Ze,Mc]]},Nv={provide:Pn,deps:[[new Ze,Mc]]};function kv(n){return(e,t)=>{let r=t.get(of);Te("angularfire",Rn.full,"core"),Te("angularfire",Rn.full,"app"),Te("angular",uf.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Dt(i)}}function Wf(n,...e){return Zn([Dv,Nv,{provide:Mc,useFactory:kv(n),multi:!0,deps:[Kt,Tn,hr,...e]}])}var Hf=tt(xc,!0);function lp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var hp=lp,dp=new Rt("auth","Firebase",lp());var Hs=new Jt("@firebase/auth");function Vv(n,...e){Hs.logLevel<=Q.WARN&&Hs.warn(`Auth (${Zt}): ${n}`,...e)}function $s(n,...e){Hs.logLevel<=Q.ERROR&&Hs.error(`Auth (${Zt}): ${n}`,...e)}function mt(n,...e){throw su(n,...e)}function Dn(n,...e){return su(n,...e)}function fp(n,e,t){let r=Object.assign(Object.assign({},hp()),{[e]:t});return new Rt("auth","Firebase",r).create(e,{appName:n.name})}function Vt(n){return fp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function su(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return dp.create(n,...e)}function $(n,e,...t){if(!n)throw su(e,...t)}function Nt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw $s(e),new Error(e)}function tn(n,e){n||Nt(e)}function Bc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function xv(){return Kf()==="http:"||Kf()==="https:"}function Kf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Ov(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xv()||Af()||"connection"in navigator)?navigator.onLine:!0}function Mv(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Nn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,tn(t>e,"Short delay should be less than long delay!"),this.isMobile=Tf()||Cf()}get(){return Ov()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function ou(n,e){tn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ks=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Nt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Nt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Nt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Fv={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Lv=new Nn(3e4,6e4);function nn(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function rn(s,a,u,l){return y(this,arguments,function*(n,e,t,r,i={}){return pp(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let v=yi(Object.assign({key:n.config.apiKey},p)).slice(1),b=yield n._getAdditionalHeaders();b["Content-Type"]="application/json",n.languageCode&&(b["X-Firebase-Locale"]=n.languageCode);let R=Object.assign({method:e,headers:b},d);return bf()||(R.referrerPolicy="no-referrer"),Ks.fetch()(mp(n,n.config.apiHost,t,v),R)}))})}function pp(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},Fv),e);try{let i=new qc(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw js(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[l,d]=u.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw js(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw js(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw js(n,"user-disabled",a);let p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw fp(n,p,d);mt(n,p)}}catch(i){if(i instanceof Je)throw i;mt(n,"network-request-failed",{message:String(i)})}})}function Di(s,a,u,l){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield rn(n,e,t,r,i);return"mfaPendingCredential"in d&&mt(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function mp(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?ou(n.config,i):`${n.config.apiScheme}://${i}`}function Uv(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var qc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Dn(this.auth,"network-request-failed")),Lv.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function js(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Dn(n,e,r);return i.customData._tokenResponse=t,i}function Qf(n){return n!==void 0&&n.enterprise!==void 0}var jc=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Uv(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function Bv(n,e){return y(this,null,function*(){return rn(n,"GET","/v2/recaptchaConfig",nn(n,e))})}function qv(n,e){return y(this,null,function*(){return rn(n,"POST","/v1/accounts:delete",e)})}function gp(n,e){return y(this,null,function*(){return rn(n,"POST","/v1/accounts:lookup",e)})}function Ti(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function au(n,e=!1){return y(this,null,function*(){let t=we(n),r=yield t.getIdToken(e),i=cu(r);$(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Ti(Fc(i.auth_time)),issuedAtTime:Ti(Fc(i.iat)),expirationTime:Ti(Fc(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Fc(n){return Number(n)*1e3}function cu(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return $s("JWT malformed, contained fewer than 3 sections"),null;try{let i=mc(t);return i?JSON.parse(i):($s("Failed to decode base64 JWT payload"),null)}catch(i){return $s("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Jf(n){let e=cu(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ai(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Je&&jv(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function jv({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var $c=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Ci=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ti(this.lastLoginAt),this.creationTime=Ti(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Qs(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ai(n,gp(t,{idToken:r}));$(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?_p(s.providerUserInfo):[],u=$v(n.providerData,a),l=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!u?.length,p=l?d:!1,v={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new Ci(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,v)})}function uu(n){return y(this,null,function*(){let e=we(n);yield Qs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function $v(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function _p(n){return n.map(e=>{var{providerId:t}=e,r=rc(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Gv(n,e){return y(this,null,function*(){let t=yield pp(n,{},()=>y(this,null,function*(){let r=yi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=mp(n,i,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Ks.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function zv(n,e){return y(this,null,function*(){return rn(n,"POST","/v2/accounts:revokeToken",nn(n,e))})}var bi=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");let t=Jf(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield Gv(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&($(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&($(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&($(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Nt("not implemented")}};function en(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var dr=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=rc(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $c(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ci(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield Ai(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return au(this,e)}reload(){return uu(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Qs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(st(this.auth.app))return Promise.reject(Vt(this.auth));let e=yield this.getIdToken();return yield Ai(this,qv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,u,l,d,p;let v=(r=t.displayName)!==null&&r!==void 0?r:void 0,b=(i=t.email)!==null&&i!==void 0?i:void 0,R=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,x=(a=t.photoURL)!==null&&a!==void 0?a:void 0,k=(u=t.tenantId)!==null&&u!==void 0?u:void 0,M=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,H=(d=t.createdAt)!==null&&d!==void 0?d:void 0,Y=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:X,emailVerified:oe,isAnonymous:Be,providerData:re,stsTokenManager:E}=t;$(X&&E,e,"internal-error");let m=bi.fromJSON(this.name,E);$(typeof X=="string",e,"internal-error"),en(v,e.name),en(b,e.name),$(typeof oe=="boolean",e,"internal-error"),$(typeof Be=="boolean",e,"internal-error"),en(R,e.name),en(x,e.name),en(k,e.name),en(M,e.name),en(H,e.name),en(Y,e.name);let _=new n({uid:X,auth:e,email:b,emailVerified:oe,displayName:v,isAnonymous:Be,photoURL:x,phoneNumber:R,tenantId:k,stsTokenManager:m,createdAt:H,lastLoginAt:Y});return re&&Array.isArray(re)&&(_.providerData=re.map(I=>Object.assign({},I))),M&&(_._redirectEventId=M),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new bi;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Qs(s),s})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];$(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?_p(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,u=new bi;u.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ci(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,d),l})}};var Yf=new Map;function kt(n){tn(n instanceof Function,"Expected a class definition");let e=Yf.get(n);return e?(tn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Yf.set(n,e),e)}var Wv=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Gc=Wv;function Gs(n,e,t){return`firebase:${n}:${e}:${t}`}var Js=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Gs(this.userKey,i.apiKey,s),this.fullPersistenceKey=Gs("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?dr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(kt(Gc),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||kt(Gc),a=Gs(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let v=dr._fromJSON(e,p);d!==s&&(u=v),s=d;break}}catch{}let l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],u&&(yield s._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function Xf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ep(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Tp(e))return"Blackberry";if(bp(e))return"Webos";if(vp(e))return"Safari";if((e.includes("chrome/")||Ip(e))&&!e.includes("edge/"))return"Chrome";if(wp(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function yp(n=Ae()){return/firefox\//i.test(n)}function vp(n=Ae()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ip(n=Ae()){return/crios\//i.test(n)}function Ep(n=Ae()){return/iemobile/i.test(n)}function wp(n=Ae()){return/android/i.test(n)}function Tp(n=Ae()){return/blackberry/i.test(n)}function bp(n=Ae()){return/webos/i.test(n)}function lu(n=Ae()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Hv(n=Ae()){var e;return lu(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Kv(){return Sf()&&document.documentMode===10}function Ap(n=Ae()){return lu(n)||wp(n)||bp(n)||Tp(n)||/windows phone/i.test(n)||Ep(n)}function Cp(n,e=[]){let t;switch(n){case"Browser":t=Xf(Ae());break;case"Worker":t=`${Xf(Ae())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Zt}/${r}`}var zc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,u)=>{try{let l=e(s);a(l)}catch(l){u(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Qv(t){return y(this,arguments,function*(n,e={}){return rn(n,"GET","/v2/passwordPolicy",nn(n,e))})}var Jv=6,Wc=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Jv,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,u;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(u=l.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Hc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ys(this),this.idTokenSubscription=new Ys(this),this.beforeStateQueue=new zc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=kt(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Js.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield gp(this,{idToken:e}),r=yield dr._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(st(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===u)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield Qs(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=Mv()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(st(this.app))return Promise.reject(Vt(this));let t=e?we(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return st(this.app)?Promise.reject(Vt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return st(this.app)?Promise.reject(Vt(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(kt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield Qv(this),t=new Wc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Rt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield zv(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&kt(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=yield Js.create(this,[kt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if($(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Cp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Vv(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Vn(n){return we(n)}var Ys=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Nf(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var io={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Yv(n){io=n}function Sp(n){return io.loadJS(n)}function Xv(){return io.recaptchaEnterpriseScript}function Zv(){return io.gapiScript}function Rp(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var eI="recaptcha-enterprise",tI="NO_RECAPTCHA",Kc=class{constructor(e){this.type=eI,this.auth=Vn(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(s){return y(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,u)=>y(this,null,function*(){Bv(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new jc(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(l=>{u(l)})}))})}function i(s,a,u){let l=window.grecaptcha;Qf(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(tI)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(u=>{if(!t&&Qf(window.grecaptcha))i(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Xv();l.length!==0&&(l+=u),Sp(l).then(()=>{i(u,s,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function Zf(n,e,t,r=!1){return y(this,null,function*(){let i=new Kc(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function Qc(n,e,t,r){return y(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield Zf(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>y(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield Zf(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)}))})}function hu(n,e){let t=Ei(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(An(s,e??{}))return i;mt(i,"already-initialized")}return t.initialize({options:e})}function nI(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(kt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function du(n,e,t){let r=Vn(n);$(r._canInitEmulator,r,"emulator-config-failed"),$(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Pp(e),{host:a,port:u}=rI(e),l=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||iI()}function Pp(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function rI(n){let e=Pp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:ep(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:ep(a)}}}function ep(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function iI(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Si=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Nt("not implemented")}_getIdTokenResponse(e){return Nt("not implemented")}_linkToIdToken(e,t){return Nt("not implemented")}_getReauthenticationResolver(e){return Nt("not implemented")}};function sI(n,e){return y(this,null,function*(){return rn(n,"POST","/v1/accounts:signUp",e)})}function oI(n,e){return y(this,null,function*(){return Di(n,"POST","/v1/accounts:signInWithPassword",nn(n,e))})}function aI(n,e){return y(this,null,function*(){return Di(n,"POST","/v1/accounts:signInWithEmailLink",nn(n,e))})}function cI(n,e){return y(this,null,function*(){return Di(n,"POST","/v1/accounts:signInWithEmailLink",nn(n,e))})}var Ri=class n extends Si{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qc(e,t,"signInWithPassword",oI);case"emailLink":return aI(e,{email:this._email,oobCode:this._password});default:mt(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qc(e,r,"signUpPassword",sI);case"emailLink":return cI(e,{idToken:t,email:this._email,oobCode:this._password});default:mt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Lc(n,e){return y(this,null,function*(){return Di(n,"POST","/v1/accounts:signInWithIdp",nn(n,e))})}function uI(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lI(n){let e=or(ar(n)).link,t=e?or(ar(e)).deep_link_id:null,r=or(ar(n)).deep_link_id;return(r?or(ar(r)).link:null)||r||t||e||n}var Xs=class n{constructor(e){var t,r,i,s,a,u;let l=or(ar(e)),d=(t=l.apiKey)!==null&&t!==void 0?t:null,p=(r=l.oobCode)!==null&&r!==void 0?r:null,v=uI((i=l.mode)!==null&&i!==void 0?i:null);$(d&&p&&v,"argument-error"),this.apiKey=d,this.operation=v,this.code=p,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=l.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=lI(e);try{return new n(t)}catch{return null}}};var Dp=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Ri._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Xs.parseLink(r);return $(i,"argument-error"),Ri._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Zs=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Jc=class extends Zs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function hI(n,e){return y(this,null,function*(){return Di(n,"POST","/v1/accounts:signUp",nn(n,e))})}var fr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let s=yield dr._fromIdTokenResponse(e,r,i),a=tp(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=tp(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function tp(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Yc=class n extends Je{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Np(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Yc._fromErrorAndOperation(n,s,e,r):s})}function dI(n,e,t=!1){return y(this,null,function*(){let r=yield Ai(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return fr._forOperation(n,"link",r)})}function fI(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(st(r.app))return Promise.reject(Vt(r));let i="reauthenticate";try{let s=yield Ai(n,Np(r,i,e,n),t);$(s.idToken,r,"internal-error");let a=cu(s.idToken);$(a,r,"internal-error");let{sub:u}=a;return $(n.uid===u,r,"user-mismatch"),fr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&mt(r,"user-mismatch"),s}})}function kp(n,e,t=!1){return y(this,null,function*(){if(st(n.app))return Promise.reject(Vt(n));let r="signIn",i=yield Np(n,r,e),s=yield fr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function fu(n,e){return y(this,null,function*(){return kp(Vn(n),e)})}function Vp(n){return y(this,null,function*(){let e=Vn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function pu(n,e,t){return y(this,null,function*(){if(st(n.app))return Promise.reject(Vt(n));let r=Vn(n),a=yield Qc(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",hI).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Vp(n),l}),u=yield fr._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(u.user),u})}function mu(n,e,t){return st(n.app)?Promise.reject(Vt(n)):fu(we(n),Dp.credential(e,t)).catch(r=>y(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Vp(n),r}))}function gu(n,e,t,r){return we(n).onIdTokenChanged(e,t,r)}function _u(n,e,t){return we(n).beforeAuthStateChanged(e,t)}var eo="__sak";var to=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(eo,"1"),this.storage.removeItem(eo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var pI=1e3,mI=10,gI=(()=>{class n extends to{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ap(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,l,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);Kv()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,mI):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},pI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Wt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Wt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Wt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),xp=gI;var _I=(()=>{class n extends to{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),yu=_I;function yI(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var vI=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,u=this.handlersMap[s];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield yI(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Op(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Xc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,l)=>{let d=Op("",20);i.port1.start();let p=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(v){let b=v;if(b.data.eventId===d)switch(b.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(b.data.response);break;default:clearTimeout(p),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function pt(){return window}function II(n){pt().location.href=n}function Mp(){return typeof pt().WorkerGlobalScope<"u"&&typeof pt().importScripts=="function"}function EI(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function wI(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function TI(){return Mp()?self:null}var Fp="firebaseLocalStorageDb",bI=1,no="firebaseLocalStorage",Lp="fbase_key",kn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function so(n,e){return n.transaction([no],e?"readwrite":"readonly").objectStore(no)}function AI(){let n=indexedDB.deleteDatabase(Fp);return new kn(n).toPromise()}function Zc(){let n=indexedDB.open(Fp,bI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(no,{keyPath:Lp})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(no)?e(r):(r.close(),yield AI(),e(yield Zc()))}))})}function np(n,e,t){return y(this,null,function*(){let r=so(n,!0).put({[Lp]:e,value:t});return new kn(r).toPromise()})}function CI(n,e){return y(this,null,function*(){let t=so(n,!1).get(e),r=yield new kn(t).toPromise();return r===void 0?null:r.value})}function rp(n,e){let t=so(n,!0).delete(e);return new kn(t).toPromise()}var SI=800,RI=3,PI=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield Zc(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>RI)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return Mp()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=vI._getInstance(TI()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield EI(),!this.activeServiceWorker)return;this.sender=new Xc(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||wI()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Zc();return yield np(t,eo,"1"),yield rp(t,eo),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>np(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>CI(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>rp(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(s=>{let a=so(s,!1).getAll();return new kn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),SI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Up=PI;var NA=Rp("rcb"),kA=new Nn(3e4,6e4);function DI(n,e){return e?kt(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Pi=class extends Si{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Lc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Lc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function NI(n){return kp(n.auth,new Pi(n),n.bypassAuthState)}function kI(n){let{auth:e,user:t}=n;return $(t,e,"internal-error"),fI(t,new Pi(n),n.bypassAuthState)}function VI(n){return y(this,null,function*(){let{auth:e,user:t}=n;return $(t,e,"internal-error"),dI(t,new Pi(n),n.bypassAuthState)})}var eu=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(l))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NI;case"linkViaPopup":case"linkViaRedirect":return VI;case"reauthViaPopup":case"reauthViaRedirect":return kI;default:mt(this.auth,"internal-error")}}resolve(e){tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var VA=new Nn(2e3,1e4);var xI="pendingRedirect",zs=new Map,tu=class n extends eu{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=zs.get(this.auth._key());if(!e){try{let r=(yield OI(this.resolver,this.auth))?yield Wt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}zs.set(this.auth._key(),e)}return this.bypassAuthState||zs.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Wt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Wt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function OI(n,e){return y(this,null,function*(){let t=LI(e),r=FI(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function MI(n,e){zs.set(n._key(),e)}function FI(n){return kt(n._redirectPersistence)}function LI(n){return Gs(xI,n.config.apiKey,n.name)}function UI(n,e,t=!1){return y(this,null,function*(){if(st(n.app))return Promise.reject(Vt(n));let r=Vn(n),i=DI(r,e),a=yield new tu(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var BI=10*60*1e3,nu=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Bp(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Dn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=BI&&this.cachedEventUids.clear(),this.cachedEventUids.has(ip(e))}saveEventToCache(e){this.cachedEventUids.add(ip(e)),this.lastProcessedEventTime=Date.now()}};function ip(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Bp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function qI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Bp(n);default:return!1}}function jI(t){return y(this,arguments,function*(n,e={}){return rn(n,"GET","/v1/projects",e)})}var $I=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,GI=/^https?/;function zI(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield jI(n);for(let t of e)try{if(WI(t))return}catch{}mt(n,"unauthorized-domain")})}function WI(n){let e=Bc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!GI.test(t))return!1;if($I.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var HI=new Nn(3e4,6e4);function sp(){let n=pt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function KI(n){return new Promise((e,t)=>{var r,i,s;function a(){sp(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sp(),t(Dn(n,"network-request-failed"))},timeout:HI.get()})}if(!((i=(r=pt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=pt().gapi)===null||s===void 0)&&s.load)a();else{let u=Rp("iframefcb");return pt()[u]=()=>{gapi.load?a():t(Dn(n,"network-request-failed"))},Sp(`${Zv()}?onload=${u}`).catch(l=>t(l))}}).catch(e=>{throw Ws=null,e})}var Ws=null;function QI(n){return Ws=Ws||KI(n),Ws}var JI=new Nn(5e3,15e3),YI="__/auth/iframe",XI="emulator/auth/iframe",ZI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eE=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tE(n){let e=n.config;$(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?ou(e,XI):`https://${n.config.authDomain}/${YI}`,r={apiKey:e.apiKey,appName:n.name,v:Zt},i=eE.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${yi(r).slice(1)}`}function nE(n){return y(this,null,function*(){let e=yield QI(n),t=pt().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:tE(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ZI,dontclear:!0},r=>new Promise((i,s)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=Dn(n,"network-request-failed"),u=pt().setTimeout(()=>{s(a)},JI.get());function l(){pt().clearTimeout(u),i(r)}r.ping(l).then(l,()=>{s(a)})})))})}var rE={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iE=500,sE=600,oE="_blank",aE="http://localhost",ro=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function cE(n,e,t,r=iE,i=sE){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",l=Object.assign(Object.assign({},rE),{width:r.toString(),height:i.toString(),top:s,left:a}),d=Ae().toLowerCase();t&&(u=Ip(d)?oE:t),yp(d)&&(e=e||aE,l.scrollbars="yes");let p=Object.entries(l).reduce((b,[R,x])=>`${b}${R}=${x},`,"");if(Hv(d)&&u!=="_self")return uE(e||"",u),new ro(null);let v=window.open(e||"",u,p);$(v,n,"popup-blocked");try{v.focus()}catch{}return new ro(v)}function uE(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var lE="__/auth/handler",hE="emulator/auth/handler",dE=encodeURIComponent("fac");function op(n,e,t,r,i,s){return y(this,null,function*(){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Zt,eventId:i};if(e instanceof Zs){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Df(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,v]of Object.entries(s||{}))a[p]=v}if(e instanceof Jc){let p=e.getScopes().filter(v=>v!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let l=yield n._getAppCheckToken(),d=l?`#${dE}=${encodeURIComponent(l)}`:"";return`${fE(n)}?${yi(u).slice(1)}${d}`})}function fE({config:n}){return n.emulator?ou(n,hE):`https://${n.authDomain}/${lE}`}var Uc="webStorageSupport",ru=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yu,this._completeRedirectFn=UI,this._overrideRedirectResult=MI}_openPopup(e,t,r,i){return y(this,null,function*(){var s;tn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield op(e,t,r,Bc(),i);return cE(e,a,Op())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let s=yield op(e,t,r,Bc(),i);return II(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(tn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield nE(e),r=new nu(e);return t.register("authEvent",i=>($(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Uc,{type:Uc},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[Uc];a!==void 0&&t(!!a),mt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=zI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ap()||vp()||lu()}},qp=ru;var ap="@firebase/auth",cp="1.7.9";var iu=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function pE(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mE(n){Xt(new et("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;$(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Cp(n)},d=new Hc(r,i,s,l);return nI(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Xt(new et("auth-internal",e=>{let t=Vn(e.getProvider("auth").getImmediate());return(r=>new iu(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Te(ap,cp,pE(n)),Te(ap,cp,"esm2017")}var gE=5*60,_E=yc("authIdTokenMaxAge")||gE,up=null,yE=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>_E)return;let i=t?.token;up!==i&&(up=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function vu(n=cr()){let e=Ei(n,"auth");if(e.isInitialized())return e.getImmediate();let t=hu(n,{popupRedirectResolver:qp,persistence:[Up,xp,yu]}),r=yc("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=yE(s.toString());_u(t,a,()=>a(t.currentUser)),gu(t,u=>a(u))}}let i=gc("auth");return i&&du(t,`http://${i}`),t}function vE(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Yv({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Dn("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",vE().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mE("Browser");var jp="auth",Re=class{constructor(e){return e}},Ni=class{constructor(){return wi(jp)}};var Iu=new Ke("angularfire2.auth-instances");function l0(n,e){let t=Bs(jp,n,e);return t&&new Re(t)}function h0(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Re(r)}}var d0={provide:Ni,deps:[[new Ze,Iu]]},f0={provide:Re,useFactory:l0,deps:[[new Ze,Iu],Dt]};function $p(n,...e){return Te("angularfire",Rn.full,"auth"),Zn([f0,d0,{provide:Iu,useFactory:h0(n),multi:!0,deps:[Kt,Tn,hr,Pn,[new Ze,lr],...e]}])}var Gp=tt(pu,!0);var zp=tt(vu,!0);var Wp=tt(mu,!0);var nm=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(j(fi),j(di))}}static{this.\u0275dir=be({type:n})}}return n})(),go=(()=>{class n extends nm{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=er(n)))(i||n)}})()}static{this.\u0275dir=be({type:n,features:[Qe]})}}return n})(),yr=new Ke("");var p0={provide:yr,useExisting:ut(()=>cn),multi:!0};function m0(){let n=hc()?hc().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var g0=new Ke(""),cn=(()=>{class n extends nm{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!m0())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(j(fi),j(di),j(g0,8))}}static{this.\u0275dir=be({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&K("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},features:[ht([p0]),Qe]})}}return n})();function sn(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function rm(n){return n!=null&&typeof n.length=="number"}var Fi=new Ke(""),_o=new Ke(""),_0=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ot=class{static min(e){return y0(e)}static max(e){return v0(e)}static required(e){return im(e)}static requiredTrue(e){return I0(e)}static email(e){return E0(e)}static minLength(e){return w0(e)}static maxLength(e){return T0(e)}static pattern(e){return b0(e)}static nullValidator(e){return ao(e)}static compose(e){return lm(e)}static composeAsync(e){return hm(e)}};function y0(n){return e=>{if(sn(e.value)||sn(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function v0(n){return e=>{if(sn(e.value)||sn(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function im(n){return sn(n.value)?{required:!0}:null}function I0(n){return n.value===!0?null:{required:!0}}function E0(n){return sn(n.value)||_0.test(n.value)?null:{email:!0}}function w0(n){return e=>sn(e.value)||!rm(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function T0(n){return e=>rm(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function b0(n){if(!n)return ao;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(sn(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function ao(n){return null}function sm(n){return n!=null}function om(n){return lf(n)?oc(n):n}function am(n){let e={};return n.forEach(t=>{e=t!=null?$e($e({},e),t):e}),Object.keys(e).length===0?null:e}function cm(n,e){return e.map(t=>t(n))}function A0(n){return!n.validate}function um(n){return n.map(e=>A0(e)?e:t=>e.validate(t))}function lm(n){if(!n)return null;let e=n.filter(sm);return e.length==0?null:function(t){return am(cm(t,e))}}function Cu(n){return n!=null?lm(um(n)):null}function hm(n){if(!n)return null;let e=n.filter(sm);return e.length==0?null:function(t){let r=cm(t,e).map(om);return rf(r).pipe(li(am))}}function Su(n){return n!=null?hm(um(n)):null}function Hp(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function dm(n){return n._rawValidators}function fm(n){return n._rawAsyncValidators}function Eu(n){return n?Array.isArray(n)?n:[n]:[]}function co(n,e){return Array.isArray(n)?n.includes(e):n===e}function Kp(n,e){let t=Eu(e);return Eu(n).forEach(i=>{co(t,i)||t.push(i)}),t}function Qp(n,e){return Eu(e).filter(t=>!co(n,t))}var uo=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Cu(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Su(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},xt=class extends uo{get formDirective(){return null}get path(){return null}},xn=class extends uo{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},lo=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},C0={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},VC=He($e({},C0),{"[class.ng-submitted]":"isSubmitted"}),vr=(()=>{class n extends lo{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(j(xn,2))}}static{this.\u0275dir=be({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&ac("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Qe]})}}return n})(),Ir=(()=>{class n extends lo{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(j(xt,10))}}static{this.\u0275dir=be({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&ac("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Qe]})}}return n})();var ki="VALID",oo="INVALID",mr="PENDING",Vi="DISABLED",on=class{},ho=class extends on{constructor(e,t){super(),this.value=e,this.source=t}},Oi=class extends on{constructor(e,t){super(),this.pristine=e,this.source=t}},Mi=class extends on{constructor(e,t){super(),this.touched=e,this.source=t}},gr=class extends on{constructor(e,t){super(),this.status=e,this.source=t}},wu=class extends on{constructor(e){super(),this.source=e}},Tu=class extends on{constructor(e){super(),this.source=e}};function Ru(n){return(yo(n)?n.validators:n)||null}function S0(n){return Array.isArray(n)?Cu(n):n||null}function Pu(n,e){return(yo(e)?e.asyncValidators:n)||null}function R0(n){return Array.isArray(n)?Su(n):n||null}function yo(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function pm(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Ns(1e3,"");if(!r[t])throw new Ns(1001,"")}function mm(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Ns(1002,"")})}var _r=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=rr(()=>this.statusReactive()),this.statusReactive=tr(void 0),this._pristine=rr(()=>this.pristineReactive()),this.pristineReactive=tr(!0),this._touched=rr(()=>this.touchedReactive()),this.touchedReactive=tr(!1),this._events=new Zd,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return St(this.statusReactive)}set status(e){St(()=>this.statusReactive.set(e))}get valid(){return this.status===ki}get invalid(){return this.status===oo}get pending(){return this.status==mr}get disabled(){return this.status===Vi}get enabled(){return this.status!==Vi}get pristine(){return St(this.pristineReactive)}set pristine(e){St(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return St(this.touchedReactive)}set touched(e){St(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Kp(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Kp(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Qp(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Qp(e,this._rawAsyncValidators))}hasValidator(e){return co(this._rawValidators,e)}hasAsyncValidator(e){return co(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(He($e({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Mi(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Mi(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(He($e({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Oi(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Oi(!0,r))}markAsPending(e={}){this.status=mr;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new gr(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(He($e({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Vi,this.errors=null,this._forEachChild(i=>{i.disable(He($e({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ho(this.value,r)),this._events.next(new gr(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(He($e({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ki,this._forEachChild(r=>{r.enable(He($e({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(He($e({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ki||this.status===mr)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ho(this.value,t)),this._events.next(new gr(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(He($e({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Vi:ki}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=mr,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=om(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new gr(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new bn,this.statusChanges=new bn}_calculateStatus(){return this._allControlsDisabled()?Vi:this.errors?oo:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mr)?mr:this._anyControlsHaveStatus(oo)?oo:ki}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Oi(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Mi(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){yo(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=S0(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=R0(this._rawAsyncValidators)}},an=class extends _r{constructor(e,t,r){super(Ru(t),Pu(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){mm(this,!0,e),Object.keys(e).forEach(r=>{pm(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var bu=class extends an{};var Li=new Ke("CallSetDisabledState",{providedIn:"root",factory:()=>vo}),vo="always";function gm(n,e){return[...e.path,n]}function fo(n,e,t=vo){Du(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),D0(n,e),k0(n,e),N0(n,e),P0(n,e)}function Jp(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),mo(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function po(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function P0(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Du(n,e){let t=dm(n);e.validator!==null?n.setValidators(Hp(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=fm(n);e.asyncValidator!==null?n.setAsyncValidators(Hp(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();po(e._rawValidators,i),po(e._rawAsyncValidators,i)}function mo(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=dm(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=fm(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return po(e._rawValidators,r),po(e._rawAsyncValidators,r),t}function D0(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&_m(n,e)})}function N0(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&_m(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function _m(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function k0(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function ym(n,e){n==null,Du(n,e)}function V0(n,e){return mo(n,e)}function vm(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function x0(n){return Object.getPrototypeOf(n.constructor)===go}function Im(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Em(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===cn?t=s:x0(s)?r=s:i=s}),i||r||t||null}function O0(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var M0={provide:xt,useExisting:ut(()=>Ui)},xi=Promise.resolve(),Ui=(()=>{class n extends xt{get submitted(){return St(this.submittedReactive)}constructor(t,r,i){super(),this.callSetDisabledState=i,this._submitted=rr(()=>this.submittedReactive()),this.submittedReactive=tr(!1),this._directives=new Set,this.ngSubmit=new bn,this.form=new an({},Cu(t),Su(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){xi.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),fo(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){xi.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){xi.then(()=>{let r=this._findContainer(t.path),i=new an({});ym(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){xi.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){xi.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),Im(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(r){return new(r||n)(j(Fi,10),j(_o,10),j(Li,8))}}static{this.\u0275dir=be({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&K("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ht([M0]),Qe]})}}return n})();function Yp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Xp(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Me=class extends _r{constructor(e=null,t,r){super(Ru(t),Pu(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),yo(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Xp(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Yp(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Yp(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Xp(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var F0=n=>n instanceof Me;var L0={provide:xn,useExisting:ut(()=>Bi)},Zp=Promise.resolve(),Bi=(()=>{class n extends xn{constructor(t,r,i,s,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new Me,this._registered=!1,this.name="",this.update=new bn,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Em(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),vm(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){fo(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Zp.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&lc(r);Zp.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?gm(t,this._parent):[t]}static{this.\u0275fac=function(r){return new(r||n)(j(xt,9),j(Fi,10),j(_o,10),j(yr,10),j(df,8),j(Li,8))}}static{this.\u0275dir=be({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ht([L0]),Qe,hi]})}}return n})(),Er=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=be({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})(),U0={provide:yr,useExisting:ut(()=>Nu),multi:!0},Nu=(()=>{class n extends go{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=er(n)))(i||n)}})()}static{this.\u0275dir=be({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&K("input",function(a){return i.onChange(a.target.value)})("blur",function(){return i.onTouched()})},features:[ht([U0]),Qe]})}}return n})();var wm=new Ke("");var B0={provide:xt,useExisting:ut(()=>ku)},ku=(()=>{class n extends xt{get submitted(){return St(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}constructor(t,r,i){super(),this.callSetDisabledState=i,this._submitted=rr(()=>this._submittedReactive()),this._submittedReactive=tr(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new bn,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(mo(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return fo(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Jp(t.control||null,t,!1),O0(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),Im(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new wu(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new Tu(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(Jp(r||null,t),F0(i)&&(fo(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);ym(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&V0(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Du(this.form,this),this._oldForm&&mo(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||n)(j(Fi,10),j(_o,10),j(Li,8))}}static{this.\u0275dir=be({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&K("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ht([B0]),Qe,hi]})}}return n})();var q0={provide:xn,useExisting:ut(()=>Vu)},Vu=(()=>{class n extends xn{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,r,i,s,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new bn,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Em(this,s)}ngOnChanges(t){this._added||this._setUpControl(),vm(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return gm(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(r){return new(r||n)(j(xt,13),j(Fi,10),j(_o,10),j(yr,10),j(wm,8))}}static{this.\u0275dir=be({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[ht([q0]),Qe,hi]})}}return n})(),j0={provide:yr,useExisting:ut(()=>Io),multi:!0};function Tm(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function $0(n){return n.split(":")[0]}var Io=(()=>{class n extends go{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let r=this._getOptionId(t),i=Tm(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=$0(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=er(n)))(i||n)}})()}static{this.\u0275dir=be({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&K("change",function(a){return i.onChange(a.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ht([j0]),Qe]})}}return n})(),Eo=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(Tm(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(r){return new(r||n)(j(di),j(fi),j(Io,9))}}static{this.\u0275dir=be({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})(),G0={provide:yr,useExisting:ut(()=>bm),multi:!0};function em(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function z0(n){return n.split(":")[0]}var bm=(()=>{class n extends go{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(s=>this._getOptionId(s));r=(s,a)=>{s._setSelected(i.indexOf(a.toString())>-1)}}else r=(i,s)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],s=r.selectedOptions;if(s!==void 0){let a=s;for(let u=0;u<a.length;u++){let l=a[u],d=this._getOptionValue(l.value);i.push(d)}}else{let a=r.options;for(let u=0;u<a.length;u++){let l=a[u];if(l.selected){let d=this._getOptionValue(l.value);i.push(d)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=z0(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=er(n)))(i||n)}})()}static{this.\u0275dir=be({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&K("change",function(a){return i.onChange(a.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ht([G0]),Qe]})}}return n})(),wo=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(em(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(em(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(r){return new(r||n)(j(di),j(fi),j(bm,9))}}static{this.\u0275dir=be({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})();var W0=(()=>{class n{constructor(){this._validator=ao}ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):ao,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=be({type:n,features:[hi]})}}return n})();var H0={provide:Fi,useExisting:ut(()=>qi),multi:!0};var qi=(()=>{class n extends W0{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=lc,this.createValidator=t=>im}enabled(t){return t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=er(n)))(i||n)}})()}static{this.\u0275dir=be({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&af("required",i._enabled?"":null)},inputs:{required:"required"},features:[ht([H0]),Qe]})}}return n})();var Am=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Vs({type:n})}static{this.\u0275inj=ks({})}}return n})(),Au=class extends _r{constructor(e,t,r){super(Ru(t),Pu(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){mm(this,!1,e),e.forEach((r,i)=>{pm(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function tm(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var Cm=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return tm(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new an(i,s)}record(t,r=null){let i=this._reduceControls(t);return new bu(i,r)}control(t,r,i){let s={};return this.useNonNullable?(tm(r)?s=r:(s.validators=r,s.asyncValidators=i),new Me(t,He($e({},s),{nonNullable:!0}))):new Me(t,r,i)}array(t,r,i){let s=t.map(a=>this._createControl(a));return new Au(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof Me)return t;if(t instanceof _r)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=lt({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var un=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Li,useValue:t.callSetDisabledState??vo}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Vs({type:n})}static{this.\u0275inj=ks({imports:[Am]})}}return n})(),Sm=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:wm,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Li,useValue:t.callSetDisabledState??vo}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Vs({type:n})}static{this.\u0275inj=ks({imports:[Am]})}}return n})();var ln=class n{userSource=new ef(null);currentUser=this.userSource.asObservable();user="";constructor(){}setUser(e){this.userSource.next(e),this.user=e}getUser(){return this.user}getUserNow(){return this.currentUser}static \u0275fac=function(t){return new(t||n)};static \u0275prov=lt({token:n,factory:n.\u0275fac,providedIn:"root"})};function K0(n,e){if(n&1&&(P(0,"div",19),N(1),S()),n&2){let t=ne();F(),it("",t.msjError,". ")}}function Q0(n,e){n&1&&(P(0,"div",20),ue(1,"span",21),S())}var bo=class n{constructor(e,t,r){this.auth=e;this.router=t;this.userService=r}email="";password="";loginError=!1;isLoading=!1;flagError=!1;msjError="";loginUser(){Wp(this.auth,this.email,this.password).then(e=>{e.user.email!==null&&(this.isLoading=!0,setTimeout(()=>{this.userService.setUser(this.email),this.isLoading=!1,this.router.navigate(["/home"])},1e3)),this.flagError=!1}).catch(e=>{switch(this.flagError=!0,console.log(e),e.code){case"auth/weak-password":this.msjError="Contrase\xF1a demasiado corta.";break;case"auth/invalid-email":this.msjError="Correo electr\xF3nico no v\xE1lido.";break;case"auth/email-already-in-use":this.msjError="El correo electr\xF3nico ya est\xE1 en uso.";break;case"auth/user-not-found":this.msjError="No se encontr\xF3 ning\xFAn usuario con este correo.";break;case"auth/wrong-password":this.msjError="Credenciales Invalidas.";break;case"auth/invalid-credential":this.msjError="Credenciales no v\xE1lidas.";break;case"auth/account-exists-with-different-credential":this.msjError="Ya existe una cuenta con un correo diferente.";break;case"auth/credential-already-in-use":this.msjError="Estas credenciales ya est\xE1n en uso por otra cuenta.";break;default:this.msjError="Error: "+e.code;break}})}autocompletar(e,t){this.email=e,this.password=t}static \u0275fac=function(t){return new(t||n)(j(Re),j(sr),j(ln))};static \u0275cmp=me({type:n,selectors:[["app-login"]],standalone:!0,features:[ge],decls:30,vars:5,consts:[["loginForm","ngForm"],[1,"container"],[1,"row","justify-content-center","mt-5"],[1,"col-md-6"],[1,"card","shadow-lg","border-light"],[1,"card-body"],[1,"card-title","text-center","text-primary","mb-4"],[3,"ngSubmit"],[1,"mb-3"],["for","email",1,"form-label"],["type","text","id","email","required","","name","email","placeholder","Introduce tu usuario",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","id","password","required","","name","password","placeholder","Introduce tu contrase\xF1a",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","alert alert-danger mt-3","role","alert",4,"ngIf"],["class","loader-container",4,"ngIf"],[1,"botones"],["type","button",1,"botones-autocompletar",3,"click"],["role","alert",1,"alert","alert-danger","mt-3"],[1,"loader-container"],[1,"loader"]],template:function(t,r){if(t&1){let i=Ee();P(0,"body")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h3",6),N(7,"Login Cl\xEDnica"),S(),P(8,"form",7,0),K("ngSubmit",function(){return le(i),he(r.loginUser())}),P(10,"div",8)(11,"label",9),N(12,"Usuario"),S(),P(13,"input",10),gi("ngModelChange",function(a){return le(i),mi(r.email,a)||(r.email=a),he(a)}),S()(),P(14,"div",8)(15,"label",11),N(16,"Contrase\xF1a"),S(),P(17,"input",12),gi("ngModelChange",function(a){return le(i),mi(r.password,a)||(r.password=a),he(a)}),S()(),P(18,"div",13)(19,"button",14),N(20,"Iniciar Sesi\xF3n"),S()(),ce(21,K0,2,1,"div",15)(22,Q0,2,0,"div",16),S(),P(23,"div",17)(24,"button",18),K("click",function(){return le(i),he(r.autocompletar("matias.skenen@gmail.com","123456"))}),N(25,"Admin"),S(),P(26,"button",18),K("click",function(){return le(i),he(r.autocompletar("micaela@gmail.com","123456"))}),N(27,"Paciente"),S(),P(28,"button",18),K("click",function(){return le(i),he(r.autocompletar("juan@gmail.com","123456"))}),N(29,"Especialista"),S()()()()()()()()}if(t&2){let i=cf(9);F(13),pi("ngModel",r.email),F(4),pi("ngModel",r.password),F(2),B("disabled",!i.form.valid),F(2),B("ngIf",r.flagError),F(),B("ngIf",r.isLoading)}},dependencies:[dt,Qt,un,Er,cn,vr,Ir,qi,Bi,Ui],styles:['@charset "UTF-8";.card[_ngcontent-%COMP%]{border-radius:10px;padding:2rem}.card-body[_ngcontent-%COMP%]{background-color:#f8f9fa}.card-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.8rem;color:#007bff}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff}.alert[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;font-weight:500}input.form-control[_ngcontent-%COMP%]{border-radius:5px;height:45px}.form-label[_ngcontent-%COMP%]{font-weight:600}body[_ngcontent-%COMP%]{background-color:#f0f8ff}']})};var Co=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=me({type:n,selectors:[["app-home"]],standalone:!0,features:[ge],decls:2,vars:0,template:function(t,r){t&1&&(P(0,"p"),N(1,"home works!"),S())}})};var Pm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dm={};var hn,Ou;(function(){var n;function e(E,m){function _(){}_.prototype=m.prototype,E.D=m.prototype,E.prototype=new _,E.prototype.constructor=E,E.C=function(I,w,A){for(var g=Array(arguments.length-2),bt=2;bt<arguments.length;bt++)g[bt-2]=arguments[bt];return m.prototype[w].apply(I,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,m,_){_||(_=0);var I=Array(16);if(typeof m=="string")for(var w=0;16>w;++w)I[w]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(w=0;16>w;++w)I[w]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=E.g[0],_=E.g[1],w=E.g[2];var A=E.g[3],g=m+(A^_&(w^A))+I[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=A+(w^m&(_^w))+I[1]+3905402710&4294967295,A=m+(g<<12&4294967295|g>>>20),g=w+(_^A&(m^_))+I[2]+606105819&4294967295,w=A+(g<<17&4294967295|g>>>15),g=_+(m^w&(A^m))+I[3]+3250441966&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(A^_&(w^A))+I[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(w^m&(_^w))+I[5]+1200080426&4294967295,A=m+(g<<12&4294967295|g>>>20),g=w+(_^A&(m^_))+I[6]+2821735955&4294967295,w=A+(g<<17&4294967295|g>>>15),g=_+(m^w&(A^m))+I[7]+4249261313&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(A^_&(w^A))+I[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(w^m&(_^w))+I[9]+2336552879&4294967295,A=m+(g<<12&4294967295|g>>>20),g=w+(_^A&(m^_))+I[10]+4294925233&4294967295,w=A+(g<<17&4294967295|g>>>15),g=_+(m^w&(A^m))+I[11]+2304563134&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(A^_&(w^A))+I[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(w^m&(_^w))+I[13]+4254626195&4294967295,A=m+(g<<12&4294967295|g>>>20),g=w+(_^A&(m^_))+I[14]+2792965006&4294967295,w=A+(g<<17&4294967295|g>>>15),g=_+(m^w&(A^m))+I[15]+1236535329&4294967295,_=w+(g<<22&4294967295|g>>>10),g=m+(w^A&(_^w))+I[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^w&(m^_))+I[6]+3225465664&4294967295,A=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(A^m))+I[11]+643717713&4294967295,w=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(w^A))+I[0]+3921069994&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^A&(_^w))+I[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^w&(m^_))+I[10]+38016083&4294967295,A=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(A^m))+I[15]+3634488961&4294967295,w=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(w^A))+I[4]+3889429448&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^A&(_^w))+I[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^w&(m^_))+I[14]+3275163606&4294967295,A=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(A^m))+I[3]+4107603335&4294967295,w=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(w^A))+I[8]+1163531501&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(w^A&(_^w))+I[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^w&(m^_))+I[2]+4243563512&4294967295,A=m+(g<<9&4294967295|g>>>23),g=w+(m^_&(A^m))+I[7]+1735328473&4294967295,w=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(w^A))+I[12]+2368359562&4294967295,_=w+(g<<20&4294967295|g>>>12),g=m+(_^w^A)+I[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^w)+I[8]+2272392833&4294967295,A=m+(g<<11&4294967295|g>>>21),g=w+(A^m^_)+I[11]+1839030562&4294967295,w=A+(g<<16&4294967295|g>>>16),g=_+(w^A^m)+I[14]+4259657740&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^A)+I[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^w)+I[4]+1272893353&4294967295,A=m+(g<<11&4294967295|g>>>21),g=w+(A^m^_)+I[7]+4139469664&4294967295,w=A+(g<<16&4294967295|g>>>16),g=_+(w^A^m)+I[10]+3200236656&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^A)+I[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^w)+I[0]+3936430074&4294967295,A=m+(g<<11&4294967295|g>>>21),g=w+(A^m^_)+I[3]+3572445317&4294967295,w=A+(g<<16&4294967295|g>>>16),g=_+(w^A^m)+I[6]+76029189&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(_^w^A)+I[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^w)+I[12]+3873151461&4294967295,A=m+(g<<11&4294967295|g>>>21),g=w+(A^m^_)+I[15]+530742520&4294967295,w=A+(g<<16&4294967295|g>>>16),g=_+(w^A^m)+I[2]+3299628645&4294967295,_=w+(g<<23&4294967295|g>>>9),g=m+(w^(_|~A))+I[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~w))+I[7]+1126891415&4294967295,A=m+(g<<10&4294967295|g>>>22),g=w+(m^(A|~_))+I[14]+2878612391&4294967295,w=A+(g<<15&4294967295|g>>>17),g=_+(A^(w|~m))+I[5]+4237533241&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~A))+I[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~w))+I[3]+2399980690&4294967295,A=m+(g<<10&4294967295|g>>>22),g=w+(m^(A|~_))+I[10]+4293915773&4294967295,w=A+(g<<15&4294967295|g>>>17),g=_+(A^(w|~m))+I[1]+2240044497&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~A))+I[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~w))+I[15]+4264355552&4294967295,A=m+(g<<10&4294967295|g>>>22),g=w+(m^(A|~_))+I[6]+2734768916&4294967295,w=A+(g<<15&4294967295|g>>>17),g=_+(A^(w|~m))+I[13]+1309151649&4294967295,_=w+(g<<21&4294967295|g>>>11),g=m+(w^(_|~A))+I[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~w))+I[11]+3174756917&4294967295,A=m+(g<<10&4294967295|g>>>22),g=w+(m^(A|~_))+I[2]+718787259&4294967295,w=A+(g<<15&4294967295|g>>>17),g=_+(A^(w|~m))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+m&4294967295,E.g[1]=E.g[1]+(w+(g<<21&4294967295|g>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+A&4294967295}r.prototype.u=function(E,m){m===void 0&&(m=E.length);for(var _=m-this.blockSize,I=this.B,w=this.h,A=0;A<m;){if(w==0)for(;A<=_;)i(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<m;)if(I[w++]=E.charCodeAt(A++),w==this.blockSize){i(this,I),w=0;break}}else for(;A<m;)if(I[w++]=E[A++],w==this.blockSize){i(this,I),w=0;break}}this.h=w,this.o+=m},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var m=1;m<E.length-8;++m)E[m]=0;var _=8*this.o;for(m=E.length-8;m<E.length;++m)E[m]=_&255,_/=256;for(this.u(E),E=Array(16),m=_=0;4>m;++m)for(var I=0;32>I;I+=8)E[_++]=this.g[m]>>>I&255;return E};function s(E,m){var _=u;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=m(E)}function a(E,m){this.h=m;for(var _=[],I=!0,w=E.length-1;0<=w;w--){var A=E[w]|0;I&&A==m||(_[w]=A,I=!1)}this.g=_}var u={};function l(E){return-128<=E&&128>E?s(E,function(m){return new a([m|0],0>m?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return v;if(0>E)return M(d(-E));for(var m=[],_=1,I=0;E>=_;I++)m[I]=E/_|0,_*=4294967296;return new a(m,0)}function p(E,m){if(E.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(E.charAt(0)=="-")return M(p(E.substring(1),m));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),I=v,w=0;w<E.length;w+=8){var A=Math.min(8,E.length-w),g=parseInt(E.substring(w,w+A),m);8>A?(A=d(Math.pow(m,A)),I=I.j(A).add(d(g))):(I=I.j(_),I=I.add(d(g)))}return I}var v=l(0),b=l(1),R=l(16777216);n=a.prototype,n.m=function(){if(k(this))return-M(this).m();for(var E=0,m=1,_=0;_<this.g.length;_++){var I=this.i(_);E+=(0<=I?I:4294967296+I)*m,m*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(x(this))return"0";if(k(this))return"-"+M(this).toString(E);for(var m=d(Math.pow(E,6)),_=this,I="";;){var w=oe(_,m).g;_=H(_,w.j(m));var A=((0<_.g.length?_.g[0]:_.h)>>>0).toString(E);if(_=w,x(_))return A+I;for(;6>A.length;)A="0"+A;I=A+I}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function x(E){if(E.h!=0)return!1;for(var m=0;m<E.g.length;m++)if(E.g[m]!=0)return!1;return!0}function k(E){return E.h==-1}n.l=function(E){return E=H(this,E),k(E)?-1:x(E)?0:1};function M(E){for(var m=E.g.length,_=[],I=0;I<m;I++)_[I]=~E.g[I];return new a(_,~E.h).add(b)}n.abs=function(){return k(this)?M(this):this},n.add=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0,w=0;w<=m;w++){var A=I+(this.i(w)&65535)+(E.i(w)&65535),g=(A>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);I=g>>>16,A&=65535,g&=65535,_[w]=g<<16|A}return new a(_,_[_.length-1]&-2147483648?-1:0)};function H(E,m){return E.add(M(m))}n.j=function(E){if(x(this)||x(E))return v;if(k(this))return k(E)?M(this).j(M(E)):M(M(this).j(E));if(k(E))return M(this.j(M(E)));if(0>this.l(R)&&0>E.l(R))return d(this.m()*E.m());for(var m=this.g.length+E.g.length,_=[],I=0;I<2*m;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(var w=0;w<E.g.length;w++){var A=this.i(I)>>>16,g=this.i(I)&65535,bt=E.i(w)>>>16,Gr=E.i(w)&65535;_[2*I+2*w]+=g*Gr,Y(_,2*I+2*w),_[2*I+2*w+1]+=A*Gr,Y(_,2*I+2*w+1),_[2*I+2*w+1]+=g*bt,Y(_,2*I+2*w+1),_[2*I+2*w+2]+=A*bt,Y(_,2*I+2*w+2)}for(I=0;I<m;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=m;I<2*m;I++)_[I]=0;return new a(_,0)};function Y(E,m){for(;(E[m]&65535)!=E[m];)E[m+1]+=E[m]>>>16,E[m]&=65535,m++}function X(E,m){this.g=E,this.h=m}function oe(E,m){if(x(m))throw Error("division by zero");if(x(E))return new X(v,v);if(k(E))return m=oe(M(E),m),new X(M(m.g),M(m.h));if(k(m))return m=oe(E,M(m)),new X(M(m.g),m.h);if(30<E.g.length){if(k(E)||k(m))throw Error("slowDivide_ only works with positive integers.");for(var _=b,I=m;0>=I.l(E);)_=Be(_),I=Be(I);var w=re(_,1),A=re(I,1);for(I=re(I,2),_=re(_,2);!x(I);){var g=A.add(I);0>=g.l(E)&&(w=w.add(_),A=g),I=re(I,1),_=re(_,1)}return m=H(E,w.j(m)),new X(w,m)}for(w=v;0<=E.l(m);){for(_=Math.max(1,Math.floor(E.m()/m.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),A=d(_),g=A.j(m);k(g)||0<g.l(E);)_-=I,A=d(_),g=A.j(m);x(A)&&(A=b),w=w.add(A),E=H(E,g)}return new X(w,E)}n.A=function(E){return oe(this,E).h},n.and=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)&E.i(I);return new a(_,this.h&E.h)},n.or=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)|E.i(I);return new a(_,this.h|E.h)},n.xor=function(E){for(var m=Math.max(this.g.length,E.g.length),_=[],I=0;I<m;I++)_[I]=this.i(I)^E.i(I);return new a(_,this.h^E.h)};function Be(E){for(var m=E.g.length+1,_=[],I=0;I<m;I++)_[I]=E.i(I)<<1|E.i(I-1)>>>31;return new a(_,E.h)}function re(E,m){var _=m>>5;m%=32;for(var I=E.g.length-_,w=[],A=0;A<I;A++)w[A]=0<m?E.i(A+_)>>>m|E.i(A+_+1)<<32-m:E.i(A+_);return new a(w,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Ou=Dm.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,hn=Dm.Integer=a}).apply(typeof Pm<"u"?Pm:typeof self<"u"?self:typeof window<"u"?window:{});var So=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ot={};var Mu,J0,wr,Fu,ji,Ro,Lu,Uu,Bu;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,h){return o==Array.prototype||o==Object.prototype||(o[c]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof So=="object"&&So];for(var c=0;c<o.length;++c){var h=o[c];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,c){if(c)e:{var h=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var T=o[f];if(!(T in h))break e;h=h[T]}o=o[o.length-1],f=h[o],c=c(f),c!=f&&c!=null&&e(h,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var h=0,f=!1,T={next:function(){if(!f&&h<o.length){var C=h++;return{value:c(C,o[C]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,h){return h})}});var a=a||{},u=this||self;function l(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function d(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,h){return o.call.apply(o.bind,arguments)}function v(o,c,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),o.apply(c,T)}}return function(){return o.apply(c,arguments)}}function b(o,c,h){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:v,b.apply(null,arguments)}function R(o,c){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function x(o,c){function h(){}h.prototype=c.prototype,o.aa=c.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,T,C){for(var O=Array(arguments.length-2),se=2;se<arguments.length;se++)O[se-2]=arguments[se];return c.prototype[T].apply(f,O)}}function k(o){let c=o.length;if(0<c){let h=Array(c);for(let f=0;f<c;f++)h[f]=o[f];return h}return[]}function M(o,c){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(l(f)){let T=o.length||0,C=f.length||0;o.length=T+C;for(let O=0;O<C;O++)o[T+O]=f[O]}else o.push(f)}}class H{constructor(c,h){this.i=c,this.j=h,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function Y(o){return/^[\s\xa0]*$/.test(o)}function X(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function oe(o){return oe[" "](o),o}oe[" "]=function(){};var Be=X().indexOf("Gecko")!=-1&&!(X().toLowerCase().indexOf("webkit")!=-1&&X().indexOf("Edge")==-1)&&!(X().indexOf("Trident")!=-1||X().indexOf("MSIE")!=-1)&&X().indexOf("Edge")==-1;function re(o,c,h){for(let f in o)c.call(h,o[f],f,o)}function E(o,c){for(let h in o)c.call(void 0,o[h],h,o)}function m(o){let c={};for(let h in o)c[h]=o[h];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,c){let h,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(h in f)o[h]=f[h];for(let C=0;C<_.length;C++)h=_[C],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function w(o){var c=1;o=o.split(":");let h=[];for(;0<c&&o.length;)h.push(o.shift()),c--;return o.length&&h.push(o.join(":")),h}function A(o){u.setTimeout(()=>{throw o},0)}function g(){var o=ka;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class bt{constructor(){this.h=this.g=null}add(c,h){let f=Gr.get();f.set(c,h),this.h?this.h.next=f:this.g=f,this.h=f}}var Gr=new H(()=>new N_,o=>o.reset());class N_{constructor(){this.next=this.g=this.h=null}set(c,h){this.h=c,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let zr,Wr=!1,ka=new bt,Xh=()=>{let o=u.Promise.resolve(void 0);zr=()=>{o.then(k_)}};var k_=()=>{for(var o;o=g();){try{o.h.call(o.g)}catch(h){A(h)}var c=Gr;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}Wr=!1};function jt(){this.s=this.s,this.C=this.C}jt.prototype.s=!1,jt.prototype.ma=function(){this.s||(this.s=!0,this.N())},jt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function De(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}De.prototype.h=function(){this.defaultPrevented=!0};var V_=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};u.addEventListener("test",h,c),u.removeEventListener("test",h,c)}catch{}return o}();function Hr(o,c){if(De.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(Be){e:{try{oe(c.nodeName);var T=!0;break e}catch{}T=!1}T||(c=null)}}else h=="mouseover"?c=o.fromElement:h=="mouseout"&&(c=o.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:x_[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Hr.aa.h.call(this)}}x(Hr,De);var x_={2:"touch",3:"pen",4:"mouse"};Hr.prototype.h=function(){Hr.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Kr="closure_listenable_"+(1e6*Math.random()|0),O_=0;function M_(o,c,h,f,T){this.listener=o,this.proxy=null,this.src=c,this.type=h,this.capture=!!f,this.ha=T,this.key=++O_,this.da=this.fa=!1}function ps(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function ms(o){this.src=o,this.g={},this.h=0}ms.prototype.add=function(o,c,h,f,T){var C=o.toString();o=this.g[C],o||(o=this.g[C]=[],this.h++);var O=xa(o,c,f,T);return-1<O?(c=o[O],h||(c.fa=!1)):(c=new M_(c,this.src,C,!!f,T),c.fa=h,o.push(c)),c};function Va(o,c){var h=c.type;if(h in o.g){var f=o.g[h],T=Array.prototype.indexOf.call(f,c,void 0),C;(C=0<=T)&&Array.prototype.splice.call(f,T,1),C&&(ps(c),o.g[h].length==0&&(delete o.g[h],o.h--))}}function xa(o,c,h,f){for(var T=0;T<o.length;++T){var C=o[T];if(!C.da&&C.listener==c&&C.capture==!!h&&C.ha==f)return T}return-1}var Oa="closure_lm_"+(1e6*Math.random()|0),Ma={};function Zh(o,c,h,f,T){if(f&&f.once)return td(o,c,h,f,T);if(Array.isArray(c)){for(var C=0;C<c.length;C++)Zh(o,c[C],h,f,T);return null}return h=Ba(h),o&&o[Kr]?o.K(c,h,d(f)?!!f.capture:!!f,T):ed(o,c,h,!1,f,T)}function ed(o,c,h,f,T,C){if(!c)throw Error("Invalid event type");var O=d(T)?!!T.capture:!!T,se=La(o);if(se||(o[Oa]=se=new ms(o)),h=se.add(c,h,f,O,C),h.proxy)return h;if(f=F_(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)V_||(T=O),T===void 0&&(T=!1),o.addEventListener(c.toString(),f,T);else if(o.attachEvent)o.attachEvent(rd(c.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function F_(){function o(h){return c.call(o.src,o.listener,h)}let c=L_;return o}function td(o,c,h,f,T){if(Array.isArray(c)){for(var C=0;C<c.length;C++)td(o,c[C],h,f,T);return null}return h=Ba(h),o&&o[Kr]?o.L(c,h,d(f)?!!f.capture:!!f,T):ed(o,c,h,!0,f,T)}function nd(o,c,h,f,T){if(Array.isArray(c))for(var C=0;C<c.length;C++)nd(o,c[C],h,f,T);else f=d(f)?!!f.capture:!!f,h=Ba(h),o&&o[Kr]?(o=o.i,c=String(c).toString(),c in o.g&&(C=o.g[c],h=xa(C,h,f,T),-1<h&&(ps(C[h]),Array.prototype.splice.call(C,h,1),C.length==0&&(delete o.g[c],o.h--)))):o&&(o=La(o))&&(c=o.g[c.toString()],o=-1,c&&(o=xa(c,h,f,T)),(h=-1<o?c[o]:null)&&Fa(h))}function Fa(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[Kr])Va(c.i,o);else{var h=o.type,f=o.proxy;c.removeEventListener?c.removeEventListener(h,f,o.capture):c.detachEvent?c.detachEvent(rd(h),f):c.addListener&&c.removeListener&&c.removeListener(f),(h=La(c))?(Va(h,o),h.h==0&&(h.src=null,c[Oa]=null)):ps(o)}}}function rd(o){return o in Ma?Ma[o]:Ma[o]="on"+o}function L_(o,c){if(o.da)o=!0;else{c=new Hr(c,this);var h=o.listener,f=o.ha||o.src;o.fa&&Fa(o),o=h.call(f,c)}return o}function La(o){return o=o[Oa],o instanceof ms?o:null}var Ua="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ba(o){return typeof o=="function"?o:(o[Ua]||(o[Ua]=function(c){return o.handleEvent(c)}),o[Ua])}function Ne(){jt.call(this),this.i=new ms(this),this.M=this,this.F=null}x(Ne,jt),Ne.prototype[Kr]=!0,Ne.prototype.removeEventListener=function(o,c,h,f){nd(this,o,c,h,f)};function qe(o,c){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=c.type||c,typeof c=="string")c=new De(c,o);else if(c instanceof De)c.target=c.target||o;else{var T=c;c=new De(f,o),I(c,T)}if(T=!0,h)for(var C=h.length-1;0<=C;C--){var O=c.g=h[C];T=gs(O,f,!0,c)&&T}if(O=c.g=o,T=gs(O,f,!0,c)&&T,T=gs(O,f,!1,c)&&T,h)for(C=0;C<h.length;C++)O=c.g=h[C],T=gs(O,f,!1,c)&&T}Ne.prototype.N=function(){if(Ne.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var h=o.g[c],f=0;f<h.length;f++)ps(h[f]);delete o.g[c],o.h--}}this.F=null},Ne.prototype.K=function(o,c,h,f){return this.i.add(String(o),c,!1,h,f)},Ne.prototype.L=function(o,c,h,f){return this.i.add(String(o),c,!0,h,f)};function gs(o,c,h,f){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var T=!0,C=0;C<c.length;++C){var O=c[C];if(O&&!O.da&&O.capture==h){var se=O.listener,Se=O.ha||O.src;O.fa&&Va(o.i,O),T=se.call(Se,f)!==!1&&T}}return T&&!f.defaultPrevented}function id(o,c,h){if(typeof o=="function")h&&(o=b(o,h));else if(o&&typeof o.handleEvent=="function")o=b(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(o,c||0)}function sd(o){o.g=id(()=>{o.g=null,o.i&&(o.i=!1,sd(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class U_ extends jt{constructor(c,h){super(),this.m=c,this.l=h,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:sd(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qr(o){jt.call(this),this.h=o,this.g={}}x(Qr,jt);var od=[];function ad(o){re(o.g,function(c,h){this.g.hasOwnProperty(h)&&Fa(c)},o),o.g={}}Qr.prototype.N=function(){Qr.aa.N.call(this),ad(this)},Qr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qa=u.JSON.stringify,B_=u.JSON.parse,q_=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function ja(){}ja.prototype.h=null;function cd(o){return o.h||(o.h=o.i())}function ud(){}var Jr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $a(){De.call(this,"d")}x($a,De);function Ga(){De.call(this,"c")}x(Ga,De);var vn={},ld=null;function _s(){return ld=ld||new Ne}vn.La="serverreachability";function hd(o){De.call(this,vn.La,o)}x(hd,De);function Yr(o){let c=_s();qe(c,new hd(c))}vn.STAT_EVENT="statevent";function dd(o,c){De.call(this,vn.STAT_EVENT,o),this.stat=c}x(dd,De);function je(o){let c=_s();qe(c,new dd(c,o))}vn.Ma="timingevent";function fd(o,c){De.call(this,vn.Ma,o),this.size=c}x(fd,De);function Xr(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},c)}function Zr(){this.g=!0}Zr.prototype.xa=function(){this.g=!1};function j_(o,c,h,f,T,C){o.info(function(){if(o.g)if(C)for(var O="",se=C.split("&"),Se=0;Se<se.length;Se++){var ee=se[Se].split("=");if(1<ee.length){var ke=ee[0];ee=ee[1];var Ve=ke.split("_");O=2<=Ve.length&&Ve[1]=="type"?O+(ke+"="+ee+"&"):O+(ke+"=redacted&")}}else O=null;else O=C;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+h+`
`+O})}function $_(o,c,h,f,T,C,O){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+h+`
`+C+" "+O})}function Qn(o,c,h,f){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+z_(o,h)+(f?" "+f:"")})}function G_(o,c){o.info(function(){return"TIMEOUT: "+c})}Zr.prototype.info=function(){};function z_(o,c){if(!o.g)return c;if(!c)return null;try{var h=JSON.parse(c);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var C=T[0];if(C!="noop"&&C!="stop"&&C!="close")for(var O=1;O<T.length;O++)T[O]=""}}}}return qa(h)}catch{return c}}var ys={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},pd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},za;function vs(){}x(vs,ja),vs.prototype.g=function(){return new XMLHttpRequest},vs.prototype.i=function(){return{}},za=new vs;function $t(o,c,h,f){this.j=o,this.i=c,this.l=h,this.R=f||1,this.U=new Qr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new md}function md(){this.i=null,this.g="",this.h=!1}var gd={},Wa={};function Ha(o,c,h){o.L=1,o.v=Ts(At(c)),o.m=h,o.P=!0,_d(o,null)}function _d(o,c){o.F=Date.now(),Is(o),o.A=At(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),Nd(h.i,"t",f),o.C=0,h=o.j.J,o.h=new md,o.g=Qd(o.j,h?c:null,!o.m),0<o.O&&(o.M=new U_(b(o.Y,o,o.g),o.O)),c=o.U,h=o.g,f=o.ca;var T="readystatechange";Array.isArray(T)||(T&&(od[0]=T.toString()),T=od);for(var C=0;C<T.length;C++){var O=Zh(h,T[C],f||c.handleEvent,!1,c.h||c);if(!O)break;c.g[O.key]=O}c=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),Yr(),j_(o.i,o.u,o.A,o.l,o.R,o.m)}$t.prototype.ca=function(o){o=o.target;let c=this.M;c&&Ct(o)==3?c.j():this.Y(o)},$t.prototype.Y=function(o){try{if(o==this.g)e:{let Ve=Ct(this.g);var c=this.g.Ba();let Xn=this.g.Z();if(!(3>Ve)&&(Ve!=3||this.g&&(this.h.h||this.g.oa()||Ld(this.g)))){this.J||Ve!=4||c==7||(c==8||0>=Xn?Yr(3):Yr(2)),Ka(this);var h=this.g.Z();this.X=h;t:if(yd(this)){var f=Ld(this.g);o="";var T=f.length,C=Ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){In(this),ei(this);var O="";break t}this.h.i=new u.TextDecoder}for(c=0;c<T;c++)this.h.h=!0,o+=this.h.i.decode(f[c],{stream:!(C&&c==T-1)});f.length=0,this.h.g+=o,this.C=0,O=this.h.g}else O=this.g.oa();if(this.o=h==200,$_(this.i,this.u,this.A,this.l,this.R,Ve,h),this.o){if(this.T&&!this.K){t:{if(this.g){var se,Se=this.g;if((se=Se.g?Se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(se)){var ee=se;break t}}ee=null}if(h=ee)Qn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qa(this,h);else{this.o=!1,this.s=3,je(12),In(this),ei(this);break e}}if(this.P){h=!0;let rt;for(;!this.J&&this.C<O.length;)if(rt=W_(this,O),rt==Wa){Ve==4&&(this.s=4,je(14),h=!1),Qn(this.i,this.l,null,"[Incomplete Response]");break}else if(rt==gd){this.s=4,je(15),Qn(this.i,this.l,O,"[Invalid Chunk]"),h=!1;break}else Qn(this.i,this.l,rt,null),Qa(this,rt);if(yd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ve!=4||O.length!=0||this.h.h||(this.s=1,je(16),h=!1),this.o=this.o&&h,!h)Qn(this.i,this.l,O,"[Invalid Chunked Response]"),In(this),ei(this);else if(0<O.length&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.ba&&!ke.M&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),tc(ke),ke.M=!0,je(11))}}else Qn(this.i,this.l,O,null),Qa(this,O);Ve==4&&In(this),this.o&&!this.J&&(Ve==4?zd(this.j,this):(this.o=!1,Is(this)))}else uy(this.g),h==400&&0<O.indexOf("Unknown SID")?(this.s=3,je(12)):(this.s=0,je(13)),In(this),ei(this)}}}catch{}finally{}};function yd(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function W_(o,c){var h=o.C,f=c.indexOf(`
`,h);return f==-1?Wa:(h=Number(c.substring(h,f)),isNaN(h)?gd:(f+=1,f+h>c.length?Wa:(c=c.slice(f,f+h),o.C=f+h,c)))}$t.prototype.cancel=function(){this.J=!0,In(this)};function Is(o){o.S=Date.now()+o.I,vd(o,o.I)}function vd(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Xr(b(o.ba,o),c)}function Ka(o){o.B&&(u.clearTimeout(o.B),o.B=null)}$t.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(G_(this.i,this.A),this.L!=2&&(Yr(),je(17)),In(this),this.s=2,ei(this)):vd(this,this.S-o)};function ei(o){o.j.G==0||o.J||zd(o.j,o)}function In(o){Ka(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,ad(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function Qa(o,c){try{var h=o.j;if(h.G!=0&&(h.g==o||Ja(h.h,o))){if(!o.K&&Ja(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Rs(h),Cs(h);else break e;ec(h),je(18)}}else h.za=T[1],0<h.za-h.T&&37500>T[2]&&h.F&&h.v==0&&!h.C&&(h.C=Xr(b(h.Za,h),6e3));if(1>=wd(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else wn(h,11)}else if((o.K||h.g==o)&&Rs(h),!Y(c))for(T=h.Da.g.parse(c),c=0;c<T.length;c++){let ee=T[c];if(h.T=ee[0],ee=ee[1],h.G==2)if(ee[0]=="c"){h.K=ee[1],h.ia=ee[2];let ke=ee[3];ke!=null&&(h.la=ke,h.j.info("VER="+h.la));let Ve=ee[4];Ve!=null&&(h.Aa=Ve,h.j.info("SVER="+h.Aa));let Xn=ee[5];Xn!=null&&typeof Xn=="number"&&0<Xn&&(f=1.5*Xn,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let rt=o.g;if(rt){let Ds=rt.g?rt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ds){var C=f.h;C.g||Ds.indexOf("spdy")==-1&&Ds.indexOf("quic")==-1&&Ds.indexOf("h2")==-1||(C.j=C.l,C.g=new Set,C.h&&(Ya(C,C.h),C.h=null))}if(f.D){let nc=rt.g?rt.g.getResponseHeader("X-HTTP-Session-Id"):null;nc&&(f.ya=nc,ae(f.I,f.D,nc))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var O=o;if(f.qa=Kd(f,f.J?f.ia:null,f.W),O.K){Td(f.h,O);var se=O,Se=f.L;Se&&(se.I=Se),se.B&&(Ka(se),Is(se)),f.g=O}else $d(f);0<h.i.length&&Ss(h)}else ee[0]!="stop"&&ee[0]!="close"||wn(h,7);else h.G==3&&(ee[0]=="stop"||ee[0]=="close"?ee[0]=="stop"?wn(h,7):Za(h):ee[0]!="noop"&&h.l&&h.l.ta(ee),h.v=0)}}Yr(4)}catch{}}var H_=class{constructor(o,c){this.g=o,this.map=c}};function Id(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ed(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function wd(o){return o.h?1:o.g?o.g.size:0}function Ja(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function Ya(o,c){o.g?o.g.add(c):o.h=c}function Td(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Id.prototype.cancel=function(){if(this.i=bd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function bd(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let h of o.g.values())c=c.concat(h.D);return c}return k(o.i)}function K_(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var c=[],h=o.length,f=0;f<h;f++)c.push(o[f]);return c}c=[],h=0;for(f in o)c[h++]=o[f];return c}function Q_(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var c=[];o=o.length;for(var h=0;h<o;h++)c.push(h);return c}c=[],h=0;for(let f in o)c[h++]=f;return c}}}function Ad(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var h=Q_(o),f=K_(o),T=f.length,C=0;C<T;C++)c.call(void 0,f[C],h&&h[C],o)}var Cd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function J_(o,c){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),T=null;if(0<=f){var C=o[h].substring(0,f);T=o[h].substring(f+1)}else C=o[h];c(C,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function En(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof En){this.h=o.h,Es(this,o.j),this.o=o.o,this.g=o.g,ws(this,o.s),this.l=o.l;var c=o.i,h=new ri;h.i=c.i,c.g&&(h.g=new Map(c.g),h.h=c.h),Sd(this,h),this.m=o.m}else o&&(c=String(o).match(Cd))?(this.h=!1,Es(this,c[1]||"",!0),this.o=ti(c[2]||""),this.g=ti(c[3]||"",!0),ws(this,c[4]),this.l=ti(c[5]||"",!0),Sd(this,c[6]||"",!0),this.m=ti(c[7]||"")):(this.h=!1,this.i=new ri(null,this.h))}En.prototype.toString=function(){var o=[],c=this.j;c&&o.push(ni(c,Rd,!0),":");var h=this.g;return(h||c=="file")&&(o.push("//"),(c=this.o)&&o.push(ni(c,Rd,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(ni(h,h.charAt(0)=="/"?Z_:X_,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",ni(h,ty)),o.join("")};function At(o){return new En(o)}function Es(o,c,h){o.j=h?ti(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function ws(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function Sd(o,c,h){c instanceof ri?(o.i=c,ny(o.i,o.h)):(h||(c=ni(c,ey)),o.i=new ri(c,o.h))}function ae(o,c,h){o.i.set(c,h)}function Ts(o){return ae(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function ti(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function ni(o,c,h){return typeof o=="string"?(o=encodeURI(o).replace(c,Y_),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Y_(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Rd=/[#\/\?@]/g,X_=/[#\?:]/g,Z_=/[#\?]/g,ey=/[#\?@]/g,ty=/#/g;function ri(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function Gt(o){o.g||(o.g=new Map,o.h=0,o.i&&J_(o.i,function(c,h){o.add(decodeURIComponent(c.replace(/\+/g," ")),h)}))}n=ri.prototype,n.add=function(o,c){Gt(this),this.i=null,o=Jn(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(c),this.h+=1,this};function Pd(o,c){Gt(o),c=Jn(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function Dd(o,c){return Gt(o),c=Jn(o,c),o.g.has(c)}n.forEach=function(o,c){Gt(this),this.g.forEach(function(h,f){h.forEach(function(T){o.call(c,T,f,this)},this)},this)},n.na=function(){Gt(this);let o=Array.from(this.g.values()),c=Array.from(this.g.keys()),h=[];for(let f=0;f<c.length;f++){let T=o[f];for(let C=0;C<T.length;C++)h.push(c[f])}return h},n.V=function(o){Gt(this);let c=[];if(typeof o=="string")Dd(this,o)&&(c=c.concat(this.g.get(Jn(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)c=c.concat(o[h])}return c},n.set=function(o,c){return Gt(this),this.i=null,o=Jn(this,o),Dd(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function Nd(o,c,h){Pd(o,c),0<h.length&&(o.i=null,o.g.set(Jn(o,c),k(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(var h=0;h<c.length;h++){var f=c[h];let C=encodeURIComponent(String(f)),O=this.V(f);for(f=0;f<O.length;f++){var T=C;O[f]!==""&&(T+="="+encodeURIComponent(String(O[f]))),o.push(T)}}return this.i=o.join("&")};function Jn(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function ny(o,c){c&&!o.j&&(Gt(o),o.i=null,o.g.forEach(function(h,f){var T=f.toLowerCase();f!=T&&(Pd(this,f),Nd(this,T,h))},o)),o.j=c}function ry(o,c){let h=new Zr;if(u.Image){let f=new Image;f.onload=R(zt,h,"TestLoadImage: loaded",!0,c,f),f.onerror=R(zt,h,"TestLoadImage: error",!1,c,f),f.onabort=R(zt,h,"TestLoadImage: abort",!1,c,f),f.ontimeout=R(zt,h,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else c(!1)}function iy(o,c){let h=new Zr,f=new AbortController,T=setTimeout(()=>{f.abort(),zt(h,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:f.signal}).then(C=>{clearTimeout(T),C.ok?zt(h,"TestPingServer: ok",!0,c):zt(h,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),zt(h,"TestPingServer: error",!1,c)})}function zt(o,c,h,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(h)}catch{}}function sy(){this.g=new q_}function oy(o,c,h){let f=h||"";try{Ad(o,function(T,C){let O=T;d(T)&&(O=qa(T)),c.push(f+C+"="+encodeURIComponent(O))})}catch(T){throw c.push(f+"type="+encodeURIComponent("_badmap")),T}}function ii(o){this.l=o.Ub||null,this.j=o.eb||!1}x(ii,ja),ii.prototype.g=function(){return new bs(this.l,this.j)},ii.prototype.i=function(o){return function(){return o}}({});function bs(o,c){Ne.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(bs,Ne),n=bs.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,oi(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,si(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,oi(this)),this.g&&(this.readyState=3,oi(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kd(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function kd(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?si(this):oi(this),this.readyState==3&&kd(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,si(this))},n.Qa=function(o){this.g&&(this.response=o,si(this))},n.ga=function(){this.g&&si(this)};function si(o){o.readyState=4,o.l=null,o.j=null,o.v=null,oi(o)}n.setRequestHeader=function(o,c){this.u.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var h=c.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=c.next();return o.join(`\r
`)};function oi(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(bs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Vd(o){let c="";return re(o,function(h,f){c+=f,c+=":",c+=h,c+=`\r
`}),c}function Xa(o,c,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=Vd(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):ae(o,c,h))}function pe(o){Ne.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(pe,Ne);var ay=/^https?$/i,cy=["POST","PUT"];n=pe.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,c,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():za.g(),this.v=this.o?cd(this.o):cd(za),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(C){xd(this,C);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)h.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let C of f.keys())h.set(C,f.get(C));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(C=>C.toLowerCase()=="content-type"),T=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(cy,c,void 0))||f||T||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[C,O]of h)this.g.setRequestHeader(C,O);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fd(this),this.u=!0,this.g.send(o),this.u=!1}catch(C){xd(this,C)}};function xd(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,Od(o),As(o)}function Od(o){o.A||(o.A=!0,qe(o,"complete"),qe(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,qe(this,"complete"),qe(this,"abort"),As(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),As(this,!0)),pe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Md(this):this.bb())},n.bb=function(){Md(this)};function Md(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Ct(o)!=4||o.Z()!=2)){if(o.u&&Ct(o)==4)id(o.Ea,0,o);else if(qe(o,"readystatechange"),Ct(o)==4){o.h=!1;try{let O=o.Z();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var h;if(!(h=c)){var f;if(f=O===0){var T=String(o.D).match(Cd)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!ay.test(T?T.toLowerCase():"")}h=f}if(h)qe(o,"complete"),qe(o,"success");else{o.m=6;try{var C=2<Ct(o)?o.g.statusText:""}catch{C=""}o.l=C+" ["+o.Z()+"]",Od(o)}}finally{As(o)}}}}function As(o,c){if(o.g){Fd(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||qe(o,"ready");try{h.onreadystatechange=f}catch{}}}function Fd(o){o.I&&(u.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function Ct(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<Ct(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),B_(c)}};function Ld(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function uy(o){let c={};o=(o.g&&2<=Ct(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(Y(o[f]))continue;var h=w(o[f]);let T=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let C=c[T]||[];c[T]=C,C.push(h)}E(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ai(o,c,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||c}function Ud(o){this.Aa=0,this.i=[],this.j=new Zr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ai("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ai("baseRetryDelayMs",5e3,o),this.cb=ai("retryDelaySeedMs",1e4,o),this.Wa=ai("forwardChannelMaxRetries",2,o),this.wa=ai("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Id(o&&o.concurrentRequestLimit),this.Da=new sy,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ud.prototype,n.la=8,n.G=1,n.connect=function(o,c,h,f){je(0),this.W=o,this.H=c||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=Kd(this,null,this.W),Ss(this)};function Za(o){if(Bd(o),o.G==3){var c=o.U++,h=At(o.I);if(ae(h,"SID",o.K),ae(h,"RID",c),ae(h,"TYPE","terminate"),ci(o,h),c=new $t(o,o.j,c),c.L=2,c.v=Ts(At(h)),h=!1,u.navigator&&u.navigator.sendBeacon)try{h=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!h&&u.Image&&(new Image().src=c.v,h=!0),h||(c.g=Qd(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Is(c)}Hd(o)}function Cs(o){o.g&&(tc(o),o.g.cancel(),o.g=null)}function Bd(o){Cs(o),o.u&&(u.clearTimeout(o.u),o.u=null),Rs(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function Ss(o){if(!Ed(o.h)&&!o.s){o.s=!0;var c=o.Ga;zr||Xh(),Wr||(zr(),Wr=!0),ka.add(c,o),o.B=0}}function ly(o,c){return wd(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Xr(b(o.Ga,o,c),Wd(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let T=new $t(this,this.j,o),C=this.o;if(this.S&&(C?(C=m(C),I(C,this.S)):C=this.S),this.m!==null||this.O||(T.H=C,C=null),this.P)e:{for(var c=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=h;break e}if(c===4096||h===this.i.length-1){c=h+1;break e}}c=1e3}else c=1e3;c=jd(this,T,c),h=At(this.I),ae(h,"RID",o),ae(h,"CVER",22),this.D&&ae(h,"X-HTTP-Session-Id",this.D),ci(this,h),C&&(this.O?c="headers="+encodeURIComponent(String(Vd(C)))+"&"+c:this.m&&Xa(h,this.m,C)),Ya(this.h,T),this.Ua&&ae(h,"TYPE","init"),this.P?(ae(h,"$req",c),ae(h,"SID","null"),T.T=!0,Ha(T,h,null)):Ha(T,h,c),this.G=2}}else this.G==3&&(o?qd(this,o):this.i.length==0||Ed(this.h)||qd(this))};function qd(o,c){var h;c?h=c.l:h=o.U++;let f=At(o.I);ae(f,"SID",o.K),ae(f,"RID",h),ae(f,"AID",o.T),ci(o,f),o.m&&o.o&&Xa(f,o.m,o.o),h=new $t(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),c&&(o.i=c.D.concat(o.i)),c=jd(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Ya(o.h,h),Ha(h,f,c)}function ci(o,c){o.H&&re(o.H,function(h,f){ae(c,f,h)}),o.l&&Ad({},function(h,f){ae(c,f,h)})}function jd(o,c,h){h=Math.min(o.i.length,h);var f=o.l?b(o.l.Na,o.l,o):null;e:{var T=o.i;let C=-1;for(;;){let O=["count="+h];C==-1?0<h?(C=T[0].g,O.push("ofs="+C)):C=0:O.push("ofs="+C);let se=!0;for(let Se=0;Se<h;Se++){let ee=T[Se].g,ke=T[Se].map;if(ee-=C,0>ee)C=Math.max(0,T[Se].g-100),se=!1;else try{oy(ke,O,"req"+ee+"_")}catch{f&&f(ke)}}if(se){f=O.join("&");break e}}}return o=o.i.splice(0,h),c.D=o,f}function $d(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;zr||Xh(),Wr||(zr(),Wr=!0),ka.add(c,o),o.v=0}}function ec(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Xr(b(o.Fa,o),Wd(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,Gd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Xr(b(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,je(10),Cs(this),Gd(this))};function tc(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function Gd(o){o.g=new $t(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=At(o.qa);ae(c,"RID","rpc"),ae(c,"SID",o.K),ae(c,"AID",o.T),ae(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&ae(c,"TO",o.ja),ae(c,"TYPE","xmlhttp"),ci(o,c),o.m&&o.o&&Xa(c,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=Ts(At(c)),h.m=null,h.P=!0,_d(h,o)}n.Za=function(){this.C!=null&&(this.C=null,Cs(this),ec(this),je(19))};function Rs(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function zd(o,c){var h=null;if(o.g==c){Rs(o),tc(o),o.g=null;var f=2}else if(Ja(o.h,c))h=c.D,Td(o.h,c),f=1;else return;if(o.G!=0){if(c.o)if(f==1){h=c.m?c.m.length:0,c=Date.now()-c.F;var T=o.B;f=_s(),qe(f,new fd(f,h)),Ss(o)}else $d(o);else if(T=c.s,T==3||T==0&&0<c.X||!(f==1&&ly(o,c)||f==2&&ec(o)))switch(h&&0<h.length&&(c=o.h,c.i=c.i.concat(h)),T){case 1:wn(o,5);break;case 4:wn(o,10);break;case 3:wn(o,6);break;default:wn(o,2)}}}function Wd(o,c){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*c}function wn(o,c){if(o.j.info("Error code "+c),c==2){var h=b(o.fb,o),f=o.Xa;let T=!f;f=new En(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Es(f,"https"),Ts(f),T?ry(f.toString(),h):iy(f.toString(),h)}else je(2);o.G=0,o.l&&o.l.sa(c),Hd(o),Bd(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function Hd(o){if(o.G=0,o.ka=[],o.l){let c=bd(o.h);(c.length!=0||o.i.length!=0)&&(M(o.ka,c),M(o.ka,o.i),o.h.i.length=0,k(o.i),o.i.length=0),o.l.ra()}}function Kd(o,c,h){var f=h instanceof En?At(h):new En(h);if(f.g!="")c&&(f.g=c+"."+f.g),ws(f,f.s);else{var T=u.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;var C=new En(null);f&&Es(C,f),c&&(C.g=c),T&&ws(C,T),h&&(C.l=h),f=C}return h=o.D,c=o.ya,h&&c&&ae(f,h,c),ae(f,"VER",o.la),ci(o,f),f}function Qd(o,c,h){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new pe(new ii({eb:h})):new pe(o.pa),c.Ha(o.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Jd(){}n=Jd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ps(){}Ps.prototype.g=function(o,c){return new We(o,c)};function We(o,c){Ne.call(this),this.g=new Ud(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!Y(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!Y(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Yn(this)}x(We,Ne),We.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},We.prototype.close=function(){Za(this.g)},We.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=qa(o),o=h);c.i.push(new H_(c.Ya++,o)),c.G==3&&Ss(c)},We.prototype.N=function(){this.g.l=null,delete this.j,Za(this.g),delete this.g,We.aa.N.call(this)};function Yd(o){$a.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let h in c){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}x(Yd,$a);function Xd(){Ga.call(this),this.status=1}x(Xd,Ga);function Yn(o){this.g=o}x(Yn,Jd),Yn.prototype.ua=function(){qe(this.g,"a")},Yn.prototype.ta=function(o){qe(this.g,new Yd(o))},Yn.prototype.sa=function(o){qe(this.g,new Xd)},Yn.prototype.ra=function(){qe(this.g,"b")},Ps.prototype.createWebChannel=Ps.prototype.g,We.prototype.send=We.prototype.o,We.prototype.open=We.prototype.m,We.prototype.close=We.prototype.close,Bu=Ot.createWebChannelTransport=function(){return new Ps},Uu=Ot.getStatEventTarget=function(){return _s()},Lu=Ot.Event=vn,Ro=Ot.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ys.NO_ERROR=0,ys.TIMEOUT=8,ys.HTTP_ERROR=6,ji=Ot.ErrorCode=ys,pd.COMPLETE="complete",Fu=Ot.EventType=pd,ud.EventType=Jr,Jr.OPEN="a",Jr.CLOSE="b",Jr.ERROR="c",Jr.MESSAGE="d",Ne.prototype.listen=Ne.prototype.K,wr=Ot.WebChannel=ud,J0=Ot.FetchXmlHttpFactory=ii,pe.prototype.listenOnce=pe.prototype.L,pe.prototype.getLastError=pe.prototype.Ka,pe.prototype.getLastErrorCode=pe.prototype.Ba,pe.prototype.getStatus=pe.prototype.Z,pe.prototype.getResponseJson=pe.prototype.Oa,pe.prototype.getResponseText=pe.prototype.oa,pe.prototype.send=pe.prototype.ea,pe.prototype.setWithCredentials=pe.prototype.Ha,Mu=Ot.XhrIo=pe}).apply(typeof So<"u"?So:typeof self<"u"?self:typeof window<"u"?window:{});var Nm="@firebase/firestore";var Ce=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ce.UNAUTHENTICATED=new Ce(null),Ce.GOOGLE_CREDENTIALS=new Ce("google-credentials-uid"),Ce.FIRST_PARTY=new Ce("first-party-uid"),Ce.MOCK_USER=new Ce("mock-user");var jr="10.14.0";var Ln=new Jt("@firebase/firestore");function $i(){return Ln.logLevel}function U(n,...e){if(Ln.logLevel<=Q.DEBUG){let t=e.map(Th);Ln.debug(`Firestore (${jr}): ${n}`,...t)}}function Ft(n,...e){if(Ln.logLevel<=Q.ERROR){let t=e.map(Th);Ln.error(`Firestore (${jr}): ${n}`,...t)}}function Pr(n,...e){if(Ln.logLevel<=Q.WARN){let t=e.map(Th);Ln.warn(`Firestore (${jr}): ${n}`,...t)}}function Th(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function G(n="Unexpected state"){let e=`FIRESTORE (${jr}) INTERNAL ASSERTION FAILED: `+n;throw Ft(e),new Error(e)}function ie(n,e){n||G()}function z(n,e){return n}var D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends Je{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var yt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Vo=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},zu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ce.UNAUTHENTICATED))}shutdown(){}},Wu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Hu=class{constructor(e){this.t=e,this.currentUser=Ce.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ie(this.o===void 0);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new yt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new yt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>y(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},u=l=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?u(l):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new yt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string"),new Vo(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string"),new Ce(e)}},Ku=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ce.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Qu=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Ku(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ce.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Ju=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Yu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ie(this.o===void 0);let r=s=>{s.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,U("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ie(typeof t.token=="string"),this.R=t.token,new Ju(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Y0(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var xo=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Y0(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function te(n,e){return n<e?-1:n>e?1:0}function Dr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Pe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new L(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?te(this.nanoseconds,e.nanoseconds):te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Pe(0,0))}static max(){return new n(new Pe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Oo=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&G(),r===void 0?r=e.length-t:r>e.length-t&&G(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},fe=class n extends Oo{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(D.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},X0=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xe=class n extends Oo{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return X0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new L(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new L(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var q=class n{constructor(e){this.path=e}static fromPath(e){return new n(fe.fromString(e))}static fromName(e){return new n(fe.fromString(e).popFirst(5))}static empty(){return new n(fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return fe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new fe(e.slice()))}};var Xu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Xu.UNKNOWN_ID=-1;function Z0(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new Pe(t+1,0):new Pe(t,r));return new Un(i,q.empty(),e)}function ew(n){return new Un(n.readTime,n.key,-1)}var Un=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),q.empty(),-1)}static max(){return new n(W.max(),q.empty(),-1)}};function tw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:te(n.largestBatchId,e.largestBatchId))}var nw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Zu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function cs(n){return y(this,null,function*(){if(n.code!==D.FAILED_PRECONDITION||n.message!==nw)throw n;U("LocalStore","Unexpectedly lost primary lease")})}var V=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),u=0;for(let l=0;l<s;l++){let d=l;t(e[d]).next(p=>{a[d]=p,++u,u===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function rw(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function us(n){return n.name==="IndexedDbTransactionError"}var dg=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function fa(n){return n==null}function Qi(n){return n===0&&1/n==-1/0}function iw(n){return typeof n=="number"&&Number.isInteger(n)&&!Qi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var sw=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],tS=[...sw,"documentOverlays"],ow=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],aw=ow,cw=[...aw,"indexConfiguration","indexState","indexEntries"];var nS=[...cw,"globals"];function km(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Wn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function fg(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var _e=class n{constructor(e,t){this.comparator=e,this.root=t||vt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,vt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cr(this.root,e,this.comparator,!0)}},Cr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},vt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();let e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}};vt.EMPTY=null,vt.RED=!0,vt.BLACK=!1;vt.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(e,t,r,i,s){return this}insert(e,t,r){return new vt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Le=class n{constructor(e){this.comparator=e,this.data=new _e(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Mo(this.data.getIterator())}getIteratorFrom(e){return new Mo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Mo=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var nt=class n{constructor(e){this.fields=e,e.sort(Xe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Le(Xe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Dr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Fo=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ue=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Fo("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ue.EMPTY_BYTE_STRING=new Ue("");var uw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lt(n){if(ie(!!n),typeof n=="string"){let e=0,t=uw.exec(n);if(ie(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:de(n.seconds),nanos:de(n.nanos)}}function de(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function pn(n){return typeof n=="string"?Ue.fromBase64String(n):Ue.fromUint8Array(n)}function bh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ah(n){let e=n.mapValue.fields.__previous_value__;return bh(e)?Ah(e):e}function Ji(n){let e=Lt(n.mapValue.fields.__local_write_time__.timestampValue);return new Pe(e.seconds,e.nanos)}var el=class{constructor(e,t,r,i,s,a,u,l,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=d}},Lo=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Po={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Bn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?bh(n)?4:mg(n)?9007199254740991:pg(n)?10:11:G()}function wt(n,e){if(n===e)return!0;let t=Bn(n);if(t!==Bn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ji(n).isEqual(Ji(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Lt(i.timestampValue),u=Lt(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return pn(i.bytesValue).isEqual(pn(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return de(i.geoPointValue.latitude)===de(s.geoPointValue.latitude)&&de(i.geoPointValue.longitude)===de(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return de(i.integerValue)===de(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=de(i.doubleValue),u=de(s.doubleValue);return a===u?Qi(a)===Qi(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return Dr(n.arrayValue.values||[],e.arrayValue.values||[],wt);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(km(a)!==km(u))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(u[l]===void 0||!wt(a[l],u[l])))return!1;return!0}(n,e);default:return G()}}function Yi(n,e){return(n.values||[]).find(t=>wt(t,e))!==void 0}function Nr(n,e){if(n===e)return 0;let t=Bn(n),r=Bn(e);if(t!==r)return te(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return te(n.booleanValue,e.booleanValue);case 2:return function(s,a){let u=de(s.integerValue||s.doubleValue),l=de(a.integerValue||a.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(n,e);case 3:return Vm(n.timestampValue,e.timestampValue);case 4:return Vm(Ji(n),Ji(e));case 5:return te(n.stringValue,e.stringValue);case 6:return function(s,a){let u=pn(s),l=pn(a);return u.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let u=s.split("/"),l=a.split("/");for(let d=0;d<u.length&&d<l.length;d++){let p=te(u[d],l[d]);if(p!==0)return p}return te(u.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let u=te(de(s.latitude),de(a.latitude));return u!==0?u:te(de(s.longitude),de(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return xm(n.arrayValue,e.arrayValue);case 10:return function(s,a){var u,l,d,p;let v=s.fields||{},b=a.fields||{},R=(u=v.value)===null||u===void 0?void 0:u.arrayValue,x=(l=b.value)===null||l===void 0?void 0:l.arrayValue,k=te(((d=R?.values)===null||d===void 0?void 0:d.length)||0,((p=x?.values)===null||p===void 0?void 0:p.length)||0);return k!==0?k:xm(R,x)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===Po.mapValue&&a===Po.mapValue)return 0;if(s===Po.mapValue)return 1;if(a===Po.mapValue)return-1;let u=s.fields||{},l=Object.keys(u),d=a.fields||{},p=Object.keys(d);l.sort(),p.sort();for(let v=0;v<l.length&&v<p.length;++v){let b=te(l[v],p[v]);if(b!==0)return b;let R=Nr(u[l[v]],d[p[v]]);if(R!==0)return R}return te(l.length,p.length)}(n.mapValue,e.mapValue);default:throw G()}}function Vm(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return te(n,e);let t=Lt(n),r=Lt(e),i=te(t.seconds,r.seconds);return i!==0?i:te(t.nanos,r.nanos)}function xm(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Nr(t[i],r[i]);if(s)return s}return te(t.length,r.length)}function kr(n){return tl(n)}function tl(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Lt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return pn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=tl(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${tl(t.fields[a])}`;return i+"}"}(n.mapValue):G()}function Om(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function nl(n){return!!n&&"integerValue"in n}function Ch(n){return!!n&&"arrayValue"in n}function Mm(n){return!!n&&"nullValue"in n}function Fm(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function No(n){return!!n&&"mapValue"in n}function pg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function zi(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Wn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=zi(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=zi(n.arrayValue.values[t]);return e}return Object.assign({},n)}function mg(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ye=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!No(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=zi(t)}setAll(e){let t=Xe.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=zi(a):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());No(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];No(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Wn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(zi(this.value))}};function gg(n){let e=[];return Wn(n.fields,(t,r)=>{let i=new Xe([t]);if(No(r)){let s=gg(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new nt(e)}var at=class n{constructor(e,t,r,i,s,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),Ye.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),Ye.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),Ye.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ye.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ye.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Vr=class{constructor(e,t){this.position=e,this.inclusive=t}};function Lm(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=q.comparator(q.fromName(a.referenceValue),t.key):r=Nr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Um(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!wt(n.position[t],e.position[t]))return!1;return!0}var xr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function lw(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Uo=class{},Ie=class n extends Uo{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new il(e,t,r):t==="array-contains"?new al(e,r):t==="in"?new cl(e,r):t==="not-in"?new ul(e,r):t==="array-contains-any"?new ll(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new sl(e,r):new ol(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Nr(t,this.value)):t!==null&&Bn(this.value)===Bn(t)&&this.matchesComparison(Nr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ct=class n extends Uo{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return _g(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function _g(n){return n.op==="and"}function yg(n){return hw(n)&&_g(n)}function hw(n){for(let e of n.filters)if(e instanceof ct)return!1;return!0}function rl(n){if(n instanceof Ie)return n.field.canonicalString()+n.op.toString()+kr(n.value);if(yg(n))return n.filters.map(e=>rl(e)).join(",");{let e=n.filters.map(t=>rl(t)).join(",");return`${n.op}(${e})`}}function vg(n,e){return n instanceof Ie?function(r,i){return i instanceof Ie&&r.op===i.op&&r.field.isEqual(i.field)&&wt(r.value,i.value)}(n,e):n instanceof ct?function(r,i){return i instanceof ct&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&vg(a,i.filters[u]),!0):!1}(n,e):void G()}function Ig(n){return n instanceof Ie?function(t){return`${t.field.canonicalString()} ${t.op} ${kr(t.value)}`}(n):n instanceof ct?function(t){return t.op.toString()+" {"+t.getFilters().map(Ig).join(" ,")+"}"}(n):"Filter"}var il=class extends Ie{constructor(e,t,r){super(e,t,r),this.key=q.fromName(r.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},sl=class extends Ie{constructor(e,t){super(e,"in",t),this.keys=Eg("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ol=class extends Ie{constructor(e,t){super(e,"not-in",t),this.keys=Eg("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Eg(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>q.fromName(r.referenceValue))}var al=class extends Ie{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ch(t)&&Yi(t.arrayValue,this.value)}},cl=class extends Ie{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Yi(this.value.arrayValue,t)}},ul=class extends Ie{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Yi(this.value.arrayValue,t)}},ll=class extends Ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ch(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Yi(this.value.arrayValue,r))}};var hl=class{constructor(e,t=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.ue=null}};function Bm(n,e=null,t=[],r=[],i=null,s=null,a=null){return new hl(n,e,t,r,i,s,a)}function Sh(n){let e=z(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>rl(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),fa(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>kr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>kr(r)).join(",")),e.ue=t}return e.ue}function Rh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lw(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!vg(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Um(n.startAt,e.startAt)&&Um(n.endAt,e.endAt)}function dl(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var qn=class{constructor(e,t=null,r=[],i=[],s=null,a="F",u=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function dw(n,e,t,r,i,s,a,u){return new qn(n,e,t,r,i,s,a,u)}function Ph(n){return new qn(n)}function qm(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function wg(n){return n.collectionGroup!==null}function Wi(n){let e=z(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Le(Xe.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new xr(s,r))}),t.has(Xe.keyField().canonicalString())||e.ce.push(new xr(Xe.keyField(),r))}return e.ce}function It(n){let e=z(n);return e.le||(e.le=fw(e,Wi(n))),e.le}function fw(n,e){if(n.limitType==="F")return Bm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new xr(i.field,s)});let t=n.endAt?new Vr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Vr(n.startAt.position,n.startAt.inclusive):null;return Bm(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function fl(n,e){let t=n.filters.concat([e]);return new qn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function pl(n,e,t){return new qn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pa(n,e){return Rh(It(n),It(e))&&n.limitType===e.limitType}function Tg(n){return`${Sh(It(n))}|lt:${n.limitType}`}function Tr(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Ig(i)).join(", ")}]`),fa(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>kr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>kr(i)).join(",")),`Target(${r})`}(It(n))}; limitType=${n.limitType})`}function ma(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):q.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Wi(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,l){let d=Lm(a,u,l);return a.inclusive?d<=0:d<0}(r.startAt,Wi(r),i)||r.endAt&&!function(a,u,l){let d=Lm(a,u,l);return a.inclusive?d>=0:d>0}(r.endAt,Wi(r),i))}(n,e)}function pw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function bg(n){return(e,t)=>{let r=!1;for(let i of Wi(n)){let s=mw(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function mw(n,e,t){let r=n.field.isKeyField()?q.comparator(e.key,t.key):function(s,a,u){let l=a.data.field(s),d=u.data.field(s);return l!==null&&d!==null?Nr(l,d):G()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return G()}}var mn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Wn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return fg(this.inner)}size(){return this.innerSize}};var gw=new _e(q.comparator);function Ut(){return gw}var Ag=new _e(q.comparator);function Gi(...n){let e=Ag;for(let t of n)e=e.insert(t.key,t);return e}function Cg(n){let e=Ag;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function On(){return Hi()}function Sg(){return Hi()}function Hi(){return new mn(n=>n.toString(),(n,e)=>n.isEqual(e))}var _w=new _e(q.comparator),yw=new Le(q.comparator);function J(...n){let e=yw;for(let t of n)e=e.add(t);return e}var vw=new Le(te);function Iw(){return vw}function Dh(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qi(e)?"-0":e}}function Rg(n){return{integerValue:""+n}}function Ew(n,e){return iw(e)?Rg(e):Dh(n,e)}var Or=class{constructor(){this._=void 0}};function ww(n,e,t){return n instanceof Mr?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&bh(s)&&(s=Ah(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof jn?Dg(n,e):n instanceof $n?Ng(n,e):function(i,s){let a=Pg(i,s),u=jm(a)+jm(i.Pe);return nl(a)&&nl(i.Pe)?Rg(u):Dh(i.serializer,u)}(n,e)}function Tw(n,e,t){return n instanceof jn?Dg(n,e):n instanceof $n?Ng(n,e):t}function Pg(n,e){return n instanceof Fr?function(r){return nl(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Mr=class extends Or{},jn=class extends Or{constructor(e){super(),this.elements=e}};function Dg(n,e){let t=kg(e);for(let r of n.elements)t.some(i=>wt(i,r))||t.push(r);return{arrayValue:{values:t}}}var $n=class extends Or{constructor(e){super(),this.elements=e}};function Ng(n,e){let t=kg(e);for(let r of n.elements)t=t.filter(i=>!wt(i,r));return{arrayValue:{values:t}}}var Fr=class extends Or{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function jm(n){return de(n.integerValue||n.doubleValue)}function kg(n){return Ch(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function bw(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof jn&&i instanceof jn||r instanceof $n&&i instanceof $n?Dr(r.elements,i.elements,wt):r instanceof Fr&&i instanceof Fr?wt(r.Pe,i.Pe):r instanceof Mr&&i instanceof Mr}(n.transform,e.transform)}var ml=class{constructor(e,t){this.version=e,this.transformResults=t}},dn=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ko(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Lr=class{};function Vg(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Bo(n.key,dn.none()):new Gn(n.key,n.data,dn.none());{let t=n.data,r=Ye.empty(),i=new Le(Xe.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Tt(n.key,r,new nt(i.toArray()),dn.none())}}function Aw(n,e,t){n instanceof Gn?function(i,s,a){let u=i.value.clone(),l=Gm(i.fieldTransforms,s,a.transformResults);u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Tt?function(i,s,a){if(!ko(i.precondition,s))return void s.convertToUnknownDocument(a.version);let u=Gm(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(xg(i)),l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Ki(n,e,t,r){return n instanceof Gn?function(s,a,u,l){if(!ko(s.precondition,a))return u;let d=s.value.clone(),p=zm(s.fieldTransforms,l,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Tt?function(s,a,u,l){if(!ko(s.precondition,a))return u;let d=zm(s.fieldTransforms,l,a),p=a.data;return p.setAll(xg(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(v=>v.field))}(n,e,t,r):function(s,a,u){return ko(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function Cw(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Pg(r.transform,i||null);s!=null&&(t===null&&(t=Ye.empty()),t.set(r.field,s))}return t||null}function $m(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Dr(r,i,(s,a)=>bw(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Gn=class extends Lr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Tt=class extends Lr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function xg(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Gm(n,e,t){let r=new Map;ie(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,Tw(a,u,t[i]))}return r}function zm(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,ww(s,a,e))}return r}var Bo=class extends Lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},gl=class extends Lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var _l=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&Aw(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ki(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ki(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Sg();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;let l=Vg(a,u);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),J())}isEqual(e){return this.batchId===e.batchId&&Dr(this.mutations,e.mutations,(t,r)=>$m(t,r))&&Dr(this.baseMutations,e.baseMutations,(t,r)=>$m(t,r))}},yl=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ie(e.mutations.length===r.length);let i=function(){return _w}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var vl=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Il=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ye,Z;function Sw(n){switch(n){default:return G();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}function Og(n){if(n===void 0)return Ft("GRPC error has no .code"),D.UNKNOWN;switch(n){case ye.OK:return D.OK;case ye.CANCELLED:return D.CANCELLED;case ye.UNKNOWN:return D.UNKNOWN;case ye.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case ye.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case ye.INTERNAL:return D.INTERNAL;case ye.UNAVAILABLE:return D.UNAVAILABLE;case ye.UNAUTHENTICATED:return D.UNAUTHENTICATED;case ye.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case ye.NOT_FOUND:return D.NOT_FOUND;case ye.ALREADY_EXISTS:return D.ALREADY_EXISTS;case ye.PERMISSION_DENIED:return D.PERMISSION_DENIED;case ye.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case ye.ABORTED:return D.ABORTED;case ye.OUT_OF_RANGE:return D.OUT_OF_RANGE;case ye.UNIMPLEMENTED:return D.UNIMPLEMENTED;case ye.DATA_LOSS:return D.DATA_LOSS;default:return G()}}(Z=ye||(ye={}))[Z.OK=0]="OK",Z[Z.CANCELLED=1]="CANCELLED",Z[Z.UNKNOWN=2]="UNKNOWN",Z[Z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Z[Z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Z[Z.NOT_FOUND=5]="NOT_FOUND",Z[Z.ALREADY_EXISTS=6]="ALREADY_EXISTS",Z[Z.PERMISSION_DENIED=7]="PERMISSION_DENIED",Z[Z.UNAUTHENTICATED=16]="UNAUTHENTICATED",Z[Z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Z[Z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Z[Z.ABORTED=10]="ABORTED",Z[Z.OUT_OF_RANGE=11]="OUT_OF_RANGE",Z[Z.UNIMPLEMENTED=12]="UNIMPLEMENTED",Z[Z.INTERNAL=13]="INTERNAL",Z[Z.UNAVAILABLE=14]="UNAVAILABLE",Z[Z.DATA_LOSS=15]="DATA_LOSS";var Wm=null;function Rw(){return new TextEncoder}var Pw=new hn([4294967295,4294967295],0);function Hm(n){let e=Rw().encode(n),t=new Ou;return t.update(e),new Uint8Array(t.digest())}function Km(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new hn([t,r],0),new hn([i,s],0)]}var El=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Mn(`Invalid padding: ${t}`);if(r<0)throw new Mn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Mn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Mn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=hn.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(hn.fromNumber(r)));return i.compare(Pw)===1&&(i=new hn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Hm(e),[r,i]=Km(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=Hm(e),[r,i]=Km(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Mn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var qo=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Xi.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new _e(te),Ut(),J())}},Xi=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,J(),J(),J())}};var Sr=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},jo=class{constructor(e,t){this.targetId=e,this.me=t}},$o=class{constructor(e,t,r=Ue.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Go=class{constructor(){this.fe=0,this.ge=Jm(),this.pe=Ue.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=J(),t=J(),r=J();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:G()}}),new Xi(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Jm()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ie(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},wl=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ut(),this.qe=Qm(),this.Qe=new _e(te)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:G()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(dl(s))if(r===0){let a=new q(s.path);this.Ue(t,a,at.newNoDocument(a,W.min()))}else ie(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),l=u?this.Xe(u,e,a):1;if(l!==0){this.je(t);let d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Wm?.et(function(p,v,b,R,x){var k,M,H,Y,X,oe;let Be={localCacheCount:p,existenceFilterCount:v.count,databaseId:b.database,projectId:b.projectId},re=v.unchangedNames;return re&&(Be.bloomFilter={applied:x===0,hashCount:(k=re?.hashCount)!==null&&k!==void 0?k:0,bitmapLength:(Y=(H=(M=re?.bits)===null||M===void 0?void 0:M.bitmap)===null||H===void 0?void 0:H.length)!==null&&Y!==void 0?Y:0,padding:(oe=(X=re?.bits)===null||X===void 0?void 0:X.padding)!==null&&oe!==void 0?oe:0,mightContain:E=>{var m;return(m=R?.mightContain(E))!==null&&m!==void 0&&m}}),Be}(a,e.me,this.Le.tt(),u,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,u;try{a=pn(r).toUint8Array()}catch(l){if(l instanceof Fo)return Pr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new El(a,i,s)}catch(l){return Pr(l instanceof Mn?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let u=this.Je(a);if(u){if(s.current&&dl(u.target)){let l=new q(u.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,at.newNoDocument(l,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let r=J();this.qe.forEach((s,a)=>{let u=!0;a.forEachWhile(l=>{let d=this.Je(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new qo(e,t,this.Qe,this.ke,r);return this.ke=Ut(),this.qe=Qm(),this.Qe=new _e(te),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Go,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Le(te),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Go),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Qm(){return new _e(q.comparator)}function Jm(){return new _e(q.comparator)}var Dw={asc:"ASCENDING",desc:"DESCENDING"},Nw={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kw={and:"AND",or:"OR"},Tl=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function bl(n,e){return n.useProto3Json||fa(e)?e:{value:e}}function zo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mg(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Vw(n,e){return zo(n,e.toTimestamp())}function Et(n){return ie(!!n),W.fromTimestamp(function(t){let r=Lt(t);return new Pe(r.seconds,r.nanos)}(n))}function Nh(n,e){return Al(n,e).canonicalString()}function Al(n,e){let t=function(i){return new fe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Fg(n){let e=fe.fromString(n);return ie(jg(e)),e}function Cl(n,e){return Nh(n.databaseId,e.path)}function qu(n,e){let t=Fg(e);if(t.get(1)!==n.databaseId.projectId)throw new L(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(Ug(t))}function Lg(n,e){return Nh(n.databaseId,e)}function xw(n){let e=Fg(n);return e.length===4?fe.emptyPath():Ug(e)}function Sl(n){return new fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ug(n){return ie(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Ym(n,e,t){return{name:Cl(n,e),fields:t.value.mapValue.fields}}function Ow(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(ie(p===void 0||typeof p=="string"),Ue.fromBase64String(p||"")):(ie(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ue.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?D.UNKNOWN:Og(d.code);return new L(p,d.message||"")}(a);t=new $o(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=qu(n,r.document.name),s=Et(r.document.updateTime),a=r.document.createTime?Et(r.document.createTime):W.min(),u=new Ye({mapValue:{fields:r.document.fields}}),l=at.newFoundDocument(i,s,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Sr(d,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=qu(n,r.document),s=r.readTime?Et(r.readTime):W.min(),a=at.newNoDocument(i,s),u=r.removedTargetIds||[];t=new Sr([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=qu(n,r.document),s=r.removedTargetIds||[];t=new Sr([],s,i,null)}else{if(!("filter"in e))return G();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Il(i,s),u=r.targetId;t=new jo(u,a)}}return t}function Mw(n,e){let t;if(e instanceof Gn)t={update:Ym(n,e.key,e.value)};else if(e instanceof Bo)t={delete:Cl(n,e.key)};else if(e instanceof Tt)t={update:Ym(n,e.key,e.data),updateMask:zw(e.fieldMask)};else{if(!(e instanceof gl))return G();t={verify:Cl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let u=a.transform;if(u instanceof Mr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof jn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof $n)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Fr)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw G()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Vw(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:G()}(n,e.precondition)),t}function Fw(n,e){return n&&n.length>0?(ie(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?Et(i.updateTime):Et(s);return a.isEqual(W.min())&&(a=Et(s)),new ml(a,i.transformResults||[])}(t,e))):[]}function Lw(n,e){return{documents:[Lg(n,e.path)]}}function Uw(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Lg(n,i);let s=function(d){if(d.length!==0)return qg(ct.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(b){return{field:br(b.field),direction:jw(b.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=bl(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function Bw(n){let e=xw(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ie(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(v){let b=Bg(v);return b instanceof ct&&yg(b)?b.getFilters():[b]}(t.where));let a=[];t.orderBy&&(a=function(v){return v.map(b=>function(x){return new xr(Ar(x.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(b))}(t.orderBy));let u=null;t.limit&&(u=function(v){let b;return b=typeof v=="object"?v.value:v,fa(b)?null:b}(t.limit));let l=null;t.startAt&&(l=function(v){let b=!!v.before,R=v.values||[];return new Vr(R,b)}(t.startAt));let d=null;return t.endAt&&(d=function(v){let b=!v.before,R=v.values||[];return new Vr(R,b)}(t.endAt)),dw(e,i,a,s,u,"F",l,d)}function qw(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return G()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Bg(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Ar(t.unaryFilter.field);return Ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ar(t.unaryFilter.field);return Ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ar(t.unaryFilter.field);return Ie.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Ar(t.unaryFilter.field);return Ie.create(a,"!=",{nullValue:"NULL_VALUE"});default:return G()}}(n):n.fieldFilter!==void 0?function(t){return Ie.create(Ar(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ct.create(t.compositeFilter.filters.map(r=>Bg(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return G()}}(t.compositeFilter.op))}(n):G()}function jw(n){return Dw[n]}function $w(n){return Nw[n]}function Gw(n){return kw[n]}function br(n){return{fieldPath:n.canonicalString()}}function Ar(n){return Xe.fromServerFormat(n.fieldPath)}function qg(n){return n instanceof Ie?function(t){if(t.op==="=="){if(Fm(t.value))return{unaryFilter:{field:br(t.field),op:"IS_NAN"}};if(Mm(t.value))return{unaryFilter:{field:br(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Fm(t.value))return{unaryFilter:{field:br(t.field),op:"IS_NOT_NAN"}};if(Mm(t.value))return{unaryFilter:{field:br(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:br(t.field),op:$w(t.op),value:t.value}}}(n):n instanceof ct?function(t){let r=t.getFilters().map(i=>qg(i));return r.length===1?r[0]:{compositeFilter:{op:Gw(t.op),filters:r}}}(n):G()}function zw(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function jg(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Zi=class n{constructor(e,t,r,i,s=W.min(),a=W.min(),u=Ue.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Rl=class{constructor(e){this.ct=e}};function Ww(n){let e=Bw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?pl(e,e.limit,"L"):e}var Wo=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(de(e.integerValue));else if("doubleValue"in e){let r=de(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Qi(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Lt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(pn(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?mg(e)?this.dt(t,Number.MAX_SAFE_INTEGER):pg(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):G()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(de(u)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),q.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Wo.vt=new Wo;var Pl=class{constructor(){this.un=new Dl}addToCollectionParentIndex(e,t){return this.un.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(Un.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(Un.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}},Dl=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Le(fe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Le(fe.comparator)).toArray()}};var iS=new Uint8Array(0);var _t=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};_t.DEFAULT_COLLECTION_PERCENTILE=10,_t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_t.DEFAULT=new _t(41943040,_t.DEFAULT_COLLECTION_PERCENTILE,_t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_t.DISABLED=new _t(-1,0,0);var es=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Nl=class{constructor(){this.changes=new mn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,at.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var kl=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Vl=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ki(r.mutation,i,nt.empty(),Pe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,J()).next(()=>r))}getLocalViewOfDocuments(e,t,r=J()){let i=On();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Gi();return s.forEach((u,l)=>{a=a.insert(u,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=On();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,J()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let s=Ut(),a=Hi(),u=function(){return Hi()}();return t.forEach((l,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Tt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Ki(p.mutation,d,p.mutation.getFieldMask(),Pe.now())):a.set(d.key,nt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var v;return u.set(d,new kl(p,(v=a.get(d))!==null&&v!==void 0?v:null))}),u))}recalculateAndSaveOverlays(e,t){let r=Hi(),i=new _e((a,u)=>a-u),s=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(l=>{let d=t.get(l);if(d===null)return;let p=r.get(l)||nt.empty();p=u.applyToLocalView(d,p),r.set(l,p);let v=(i.get(u.batchId)||J()).add(l);i=i.insert(u.batchId,v)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let l=u.getNext(),d=l.key,p=l.value,v=Sg();p.forEach(b=>{if(!s.has(b)){let R=Vg(t.get(b),r.get(b));R!==null&&v.set(b,R),s=s.add(b)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,v))}return V.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return q.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):wg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):V.resolve(On()),u=-1,l=s;return a.next(d=>V.forEach(d,(p,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),s.get(p)?V.resolve():this.remoteDocumentCache.getEntry(e,p).next(b=>{l=l.insert(p,b)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,J())).next(p=>({batchId:u,changes:Cg(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(r=>{let i=Gi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=Gi();return this.indexManager.getCollectionParents(e,s).next(u=>V.forEach(u,l=>{let d=function(v,b){return new qn(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((v,b)=>{a=a.insert(v,b)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,at.newInvalidDocument(p)))});let u=Gi();return a.forEach((l,d)=>{let p=s.get(l);p!==void 0&&Ki(p.mutation,d,nt.empty(),Pe.now()),ma(t,d)&&(u=u.insert(l,d))}),u})}};var xl=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return V.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Et(i.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Ww(i.bundledQuery),readTime:Et(i.readTime)}}(t)),V.resolve()}};var Ol=class{constructor(){this.overlays=new _e(q.comparator),this.Ir=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){let r=On();return V.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),V.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){let i=On(),s=t.length+1,a=new q(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let l=u.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return V.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new _e((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=On(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=On(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return V.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new vl(t,r));let s=this.Ir.get(t);s===void 0&&(s=J(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var Ml=class{constructor(){this.sessionToken=Ue.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}};var ts=class{constructor(){this.Tr=new Le(ve.Er),this.dr=new Le(ve.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new ve(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new ve(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new q(new fe([])),r=new ve(t,e),i=new ve(t,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new q(new fe([])),r=new ve(t,e),i=new ve(t,e+1),s=J();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new ve(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ve=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return q.comparator(e.key,t.key)||te(e.wr,t.wr)}static Ar(e,t){return te(e.wr,t.wr)||q.comparator(e.key,t.key)}};var Fl=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Le(ve.Er)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new _l(s,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new ve(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return V.resolve(a)}lookupMutationBatch(e,t){return V.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ve(t,0),i=new ve(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);s.push(u)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Le(te);return t.forEach(i=>{let s=new ve(i,0),a=new ve(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],u=>{r=r.add(u.wr)})}),V.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;q.isDocumentKey(s)||(s=s.child(""));let a=new ve(new q(s),0),u=new Le(te);return this.br.forEachWhile(l=>{let d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(l.wr)),!0)},a),V.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ie(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return V.forEach(t.mutations,i=>{let s=new ve(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new ve(t,0),i=this.br.firstAfterOrEqual(r);return V.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ll=class{constructor(e){this.Mr=e,this.docs=function(){return new _e(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():at.newInvalidDocument(t))}getEntries(e,t){let r=Ut();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():at.newInvalidDocument(i))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ut(),a=t.path,u=new q(a.child("")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){let{key:d,value:{document:p}}=l.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||tw(ew(p),r)<=0||(i.has(p.key)||ma(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,t,r,i){G()}Or(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Ul(this)}getSize(e){return V.resolve(this.size)}},Ul=class extends Nl{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Bl=class{constructor(e){this.persistence=e,this.Nr=new mn(t=>Sh(t),Rh),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ts,this.targetCount=0,this.kr=es.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),V.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new es(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.Kn(t),V.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),V.waitFor(s).next(()=>i)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),V.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.Br.containsKey(t))}};var ql=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new dg(0),this.Kr=!1,this.Kr=!0,this.$r=new Ml,this.referenceDelegate=e(this),this.Ur=new Bl(this),this.indexManager=new Pl,this.remoteDocumentCache=function(i){return new Ll(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Rl(t),this.Gr=new xl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ol,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Fl(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);let i=new jl(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return V.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},jl=class extends Zu{constructor(e){super(),this.currentSequenceNumber=e}},$l=class n{constructor(e){this.persistence=e,this.Jr=new ts,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw G()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),V.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Xr,r=>{let i=q.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,W.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return V.or([()=>V.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Gl=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=J(),i=J();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var zl=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Wl=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Rf()?8:rw(Ae())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new zl;return this.Xi(e,t,a).next(u=>{if(s.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?($i()<=Q.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",Tr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),V.resolve()):($i()<=Q.DEBUG&&U("QueryEngine","Query:",Tr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?($i()<=Q.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",Tr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,It(t))):V.resolve())}Yi(e,t){if(qm(t))return V.resolve(null);let r=It(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=pl(t,null,"F"),r=It(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=J(...s);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(l=>{let d=this.ts(t,u);return this.ns(t,d,a,l.readTime)?this.Yi(e,pl(t,null,"F")):this.rs(e,d,t,l)}))})))}Zi(e,t,r,i){return qm(t)||i.isEqual(W.min())?V.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let a=this.ts(t,s);return this.ns(t,a,r,i)?V.resolve(null):($i()<=Q.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Tr(t)),this.rs(e,a,t,Z0(i,-1)).next(u=>u))})}ts(e,t){let r=new Le(bg(e));return t.forEach((i,s)=>{ma(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return $i()<=Q.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Tr(t)),this.Ji.getDocumentsMatchingQuery(e,t,Un.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Hl=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new _e(te),this._s=new mn(s=>Sh(s),Rh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vl(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function Hw(n,e,t,r){return new Hl(n,e,t,r)}function $g(n,e){return y(this,null,function*(){let t=z(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],u=[],l=J();for(let d of i){a.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}return t.localDocuments.getDocuments(r,l).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function Kw(n,e){let t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,l,d,p){let v=d.batch,b=v.keys(),R=V.resolve();return b.forEach(x=>{R=R.next(()=>p.getEntry(l,x)).next(k=>{let M=d.docVersions.get(x);ie(M!==null),k.version.compareTo(M)<0&&(v.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),p.addEntry(k)))})}),R.next(()=>u.mutationQueue.removeMutationBatch(l,v))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=J();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(l=l.add(u.batch.mutations[d].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Gg(n){let e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Qw(n,e){let t=z(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,v)=>{let b=i.get(v);if(!b)return;u.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,v).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,v)));let R=b.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?R=R.withResumeToken(Ue.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):p.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(p.resumeToken,r)),i=i.insert(v,R),function(k,M,H){return k.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0}(b,R,p)&&u.push(t.Ur.updateTargetData(s,R))});let l=Ut(),d=J();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(Jw(s,a,e.documentUpdates).next(p=>{l=p.Ps,d=p.Is})),!r.isEqual(W.min())){let p=t.Ur.getLastRemoteSnapshotVersion(s).next(v=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return V.waitFor(u).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(t.os=i,s))}function Jw(n,e,t){let r=J(),i=J();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Ut();return t.forEach((u,l)=>{let d=s.get(u);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(W.min())?(e.removeEntry(u,l.readTime),a=a.insert(u,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),a=a.insert(u,l)):U("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function Yw(n,e){let t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Xw(n,e){let t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,V.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new Zi(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Kl(n,e,t){return y(this,null,function*(){let r=z(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!us(a))throw a;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Xm(n,e,t){let r=z(n),i=W.min(),s=J();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,d,p){let v=z(l),b=v._s.get(p);return b!==void 0?V.resolve(v.os.get(b)):v.Ur.getTargetData(d,p)}(r,a,It(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:W.min(),t?s:J())).next(u=>(Zw(r,pw(e),u),{documents:u,Ts:s})))}function Zw(n,e,t){let r=n.us.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var Ho=class{constructor(){this.activeTargetIds=Iw()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Ql=class{constructor(){this.so=new Ho,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ho,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Jl=class{_o(e){}shutdown(){}};var Ko=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Do=null;function ju(){return Do===null?Do=function(){return 268435456+Math.round(2147483648*Math.random())}():Do++,"0x"+Do.toString(16)}var eT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Yl=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Fe="WebChannelConnection",Xl=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,a){let u=ju(),l=this.xo(t,r.toUriEncodedString());U("RestConnection",`Sending RPC '${t}' ${u}:`,l,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,a),this.No(t,l,d,i).then(p=>(U("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw Pr("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",l,"request:",i),p})}Lo(t,r,i,s,a,u){return this.Mo(t,r,i,s,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+jr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,r){let i=eT[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=ju();return new Promise((a,u)=>{let l=new Mu;l.setWithCredentials(!0),l.listenOnce(Fu.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ji.NO_ERROR:let p=l.getResponseJson();U(Fe,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case ji.TIMEOUT:U(Fe,`RPC '${e}' ${s} timed out`),u(new L(D.DEADLINE_EXCEEDED,"Request time out"));break;case ji.HTTP_ERROR:let v=l.getStatus();if(U(Fe,`RPC '${e}' ${s} failed with status:`,v,"response text:",l.getResponseText()),v>0){let b=l.getResponseJson();Array.isArray(b)&&(b=b[0]);let R=b?.error;if(R&&R.status&&R.message){let x=function(M){let H=M.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(H)>=0?H:D.UNKNOWN}(R.status);u(new L(x,R.message))}else u(new L(D.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new L(D.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{U(Fe,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);U(Fe,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=ju(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Bu(),u=Uu(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let p=s.join("");U(Fe,`Creating RPC '${e}' stream ${i}: ${p}`,l);let v=a.createWebChannel(p,l),b=!1,R=!1,x=new Yl({Io:M=>{R?U(Fe,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(b||(U(Fe,`Opening RPC '${e}' stream ${i} transport.`),v.open(),b=!0),U(Fe,`RPC '${e}' stream ${i} sending:`,M),v.send(M))},To:()=>v.close()}),k=(M,H,Y)=>{M.listen(H,X=>{try{Y(X)}catch(oe){setTimeout(()=>{throw oe},0)}})};return k(v,wr.EventType.OPEN,()=>{R||(U(Fe,`RPC '${e}' stream ${i} transport opened.`),x.yo())}),k(v,wr.EventType.CLOSE,()=>{R||(R=!0,U(Fe,`RPC '${e}' stream ${i} transport closed`),x.So())}),k(v,wr.EventType.ERROR,M=>{R||(R=!0,Pr(Fe,`RPC '${e}' stream ${i} transport errored:`,M),x.So(new L(D.UNAVAILABLE,"The operation could not be completed")))}),k(v,wr.EventType.MESSAGE,M=>{var H;if(!R){let Y=M.data[0];ie(!!Y);let X=Y,oe=X.error||((H=X[0])===null||H===void 0?void 0:H.error);if(oe){U(Fe,`RPC '${e}' stream ${i} received error:`,oe);let Be=oe.status,re=function(_){let I=ye[_];if(I!==void 0)return Og(I)}(Be),E=oe.message;re===void 0&&(re=D.INTERNAL,E="Unknown error status: "+Be+" with message "+oe.message),R=!0,x.So(new L(re,E)),v.close()}else U(Fe,`RPC '${e}' stream ${i} received:`,Y),x.bo(Y)}}),k(u,Lu.STAT_EVENT,M=>{M.stat===Ro.PROXY?U(Fe,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===Ro.NOPROXY&&U(Fe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}};function $u(){return typeof document<"u"?document:null}function ga(n){return new Tl(n,!0)}var Qo=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Jo=class{constructor(e,t,r,i,s,a,u,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Qo(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(Ft(t.toString()),Ft("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new L(D.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Zl=class extends Jo{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=Ow(this.serializer,e),r=function(s){if(!("targetChange"in s))return W.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?W.min():a.readTime?Et(a.readTime):W.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Sl(this.serializer),t.addTarget=function(s,a){let u,l=a.target;if(u=dl(l)?{documents:Lw(s,l)}:{query:Uw(s,l)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Mg(s,a.resumeToken);let d=bl(s,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(W.min())>0){u.readTime=zo(s,a.snapshotVersion.toTimestamp());let d=bl(s,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=qw(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Sl(this.serializer),t.removeTarget=e,this.a_(t)}},eh=class extends Jo{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ie(!!e.streamToken),this.lastStreamToken=e.streamToken,ie(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=Fw(e.writeResults,e.commitTime),r=Et(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Sl(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Mw(this.serializer,r))};this.a_(t)}};var th=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new L(D.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Al(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(D.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Al(t,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(D.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},nh=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ft(t),this.D_=!1):U("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var rh=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(()=>y(this,null,function*(){Hn(this)&&(U("RemoteStore","Restarting streams for network reachability change."),yield function(l){return y(this,null,function*(){let d=z(l);d.L_.add(4),yield ls(d),d.q_.set("Unknown"),d.L_.delete(4),yield _a(d)})}(this))}))}),this.q_=new nh(r,i)}};function _a(n){return y(this,null,function*(){if(Hn(n))for(let e of n.B_)yield e(!0)})}function ls(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function zg(n,e){let t=z(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Oh(t)?xh(t):$r(t).r_()&&Vh(t,e))}function kh(n,e){let t=z(n),r=$r(t);t.N_.delete(e),r.r_()&&Wg(t,e),t.N_.size===0&&(r.r_()?r.o_():Hn(t)&&t.q_.set("Unknown"))}function Vh(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$r(n).A_(e)}function Wg(n,e){n.Q_.xe(e),$r(n).R_(e)}function xh(n){n.Q_=new wl({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),$r(n).start(),n.q_.v_()}function Oh(n){return Hn(n)&&!$r(n).n_()&&n.N_.size>0}function Hn(n){return z(n).L_.size===0}function Hg(n){n.Q_=void 0}function tT(n){return y(this,null,function*(){n.q_.set("Online")})}function nT(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{Vh(n,e)})})}function rT(n,e){return y(this,null,function*(){Hg(n),Oh(n)?(n.q_.M_(e),xh(n)):n.q_.set("Unknown")})}function iT(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof $o&&e.state===2&&e.cause)try{yield function(i,s){return y(this,null,function*(){let a=s.cause;for(let u of s.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Yo(n,r)}else if(e instanceof Sr?n.Q_.Ke(e):e instanceof jo?n.Q_.He(e):n.Q_.We(e),!t.isEqual(W.min()))try{let r=yield Gg(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let u=s.Q_.rt(a);return u.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){let p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(l.resumeToken,a))}}),u.targetMismatches.forEach((l,d)=>{let p=s.N_.get(l);if(!p)return;s.N_.set(l,p.withResumeToken(Ue.EMPTY_BYTE_STRING,p.snapshotVersion)),Wg(s,l);let v=new Zi(p.target,l,d,p.sequenceNumber);Vh(s,v)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){U("RemoteStore","Failed to raise snapshot:",r),yield Yo(n,r)}})}function Yo(n,e,t){return y(this,null,function*(){if(!us(e))throw e;n.L_.add(1),yield ls(n),n.q_.set("Offline"),t||(t=()=>Gg(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){U("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield _a(n)}))})}function Kg(n,e){return e().catch(t=>Yo(n,t,e))}function ya(n){return y(this,null,function*(){let e=z(n),t=gn(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;sT(e);)try{let i=yield Yw(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,oT(e,i)}catch(i){yield Yo(e,i)}Qg(e)&&Jg(e)})}function sT(n){return Hn(n)&&n.O_.length<10}function oT(n,e){n.O_.push(e);let t=gn(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Qg(n){return Hn(n)&&!gn(n).n_()&&n.O_.length>0}function Jg(n){gn(n).start()}function aT(n){return y(this,null,function*(){gn(n).p_()})}function cT(n){return y(this,null,function*(){let e=gn(n);for(let t of n.O_)e.m_(t.mutations)})}function uT(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=yl.from(r,e,t);yield Kg(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ya(n)})}function lT(n,e){return y(this,null,function*(){e&&gn(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return Sw(a)&&a!==D.ABORTED}(i.code)){let s=r.O_.shift();gn(r).s_(),yield Kg(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield ya(r)}})}(n,e)),Qg(n)&&Jg(n)})}function Zm(n,e){return y(this,null,function*(){let t=z(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");let r=Hn(t);t.L_.add(3),yield ls(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield _a(t)})}function hT(n,e){return y(this,null,function*(){let t=z(n);e?(t.L_.delete(2),yield _a(t)):e||(t.L_.add(2),yield ls(t),t.q_.set("Unknown"))})}function $r(n){return n.K_||(n.K_=function(t,r,i){let s=z(t);return s.w_(),new Zl(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:tT.bind(null,n),Ro:nT.bind(null,n),mo:rT.bind(null,n),d_:iT.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),Oh(n)?xh(n):n.q_.set("Unknown")):(yield n.K_.stop(),Hg(n))}))),n.K_}function gn(n){return n.U_||(n.U_=function(t,r,i){let s=z(t);return s.w_(),new eh(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:aT.bind(null,n),mo:lT.bind(null,n),f_:cT.bind(null,n),g_:uT.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield ya(n)):(yield n.U_.stop(),n.O_.length>0&&(U("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var ih=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new yt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,u=new n(e,t,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Mh(n,e){if(Ft("AsyncQueue",`${e}: ${n}`),us(n))return new L(D.UNAVAILABLE,`${e}: ${n}`);throw n}var Xo=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||q.comparator(t.key,r.key):(t,r)=>q.comparator(t.key,r.key),this.keyedMap=Gi(),this.sortedSet=new _e(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Zo=class{constructor(){this.W_=new _e(q.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):G():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},Ur=class n{constructor(e,t,r,i,s,a,u,l,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,Xo.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var sh=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},oh=class{constructor(){this.queries=eg(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=z(t),s=i.queries;i.queries=eg(),s.forEach((a,u)=>{for(let l of u.j_)l.onError(r)})})(this,new L(D.ABORTED,"Firestore shutting down"))}};function eg(){return new mn(n=>Tg(n),pa)}function Yg(n,e){return y(this,null,function*(){let t=z(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new sh,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=Mh(a,`Initialization of query '${Tr(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Fh(t)})}function Xg(n,e){return y(this,null,function*(){let t=z(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function dT(n,e){let t=z(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&Fh(t)}function fT(n,e,t){let r=z(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function Fh(n){n.Y_.forEach(e=>{e.next()})}var ah,tg;(tg=ah||(ah={})).ea="default",tg.Cache="cache";var ea=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ur(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Ur.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ah.Cache}};var ta=class{constructor(e){this.key=e}},na=class{constructor(e){this.key=e}},ch=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=J(),this.mutatedKeys=J(),this.Aa=bg(e),this.Ra=new Xo(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Zo,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,v)=>{let b=i.get(p),R=ma(this.query,v)?v:null,x=!!b&&this.mutatedKeys.has(b.key),k=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations),M=!1;b&&R?b.data.isEqual(R.data)?x!==k&&(r.track({type:3,doc:R}),M=!0):this.ga(b,R)||(r.track({type:2,doc:R}),M=!0,(l&&this.Aa(R,l)>0||d&&this.Aa(R,d)<0)&&(u=!0)):!b&&R?(r.track({type:0,doc:R}),M=!0):b&&!R&&(r.track({type:1,doc:b}),M=!0,(l||d)&&(u=!0)),M&&(R?(a=a.add(R),s=k?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,v)=>function(R,x){let k=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return k(R)-k(x)}(p.type,v.type)||this.Aa(p.doc,v.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,d=l!==this.Ea;return this.Ea=l,a.length!==0||d?{snapshot:new Ur(this.query,e.Ra,s,a,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Zo,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=J(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new na(r))}),this.da.forEach(r=>{e.has(r)||t.push(new ta(r))}),t}ba(e){this.Ta=e.Ts,this.da=J();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ur.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},uh=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},lh=class{constructor(e){this.key=e,this.va=!1}},hh=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new mn(u=>Tg(u),pa),this.Ma=new Map,this.xa=new Set,this.Oa=new _e(q.comparator),this.Na=new Map,this.La=new ts,this.Ba={},this.ka=new Map,this.qa=es.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function pT(n,e,t=!0){return y(this,null,function*(){let r=i_(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield Zg(r,e,t,!0),i})}function mT(n,e){return y(this,null,function*(){let t=i_(n);yield Zg(t,e,!0,!1)})}function Zg(n,e,t,r){return y(this,null,function*(){let i=yield Xw(n.localStore,It(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),u;return r&&(u=yield gT(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&zg(n.remoteStore,i),u})}function gT(n,e,t,r,i){return y(this,null,function*(){n.Ka=(v,b,R)=>function(k,M,H,Y){return y(this,null,function*(){let X=M.view.ma(H);X.ns&&(X=yield Xm(k.localStore,M.query,!1).then(({documents:E})=>M.view.ma(E,X)));let oe=Y&&Y.targetChanges.get(M.targetId),Be=Y&&Y.targetMismatches.get(M.targetId)!=null,re=M.view.applyChanges(X,k.isPrimaryClient,oe,Be);return rg(k,M.targetId,re.wa),re.snapshot})}(n,v,b,R);let s=yield Xm(n.localStore,e,!0),a=new ch(e,s.Ts),u=a.ma(s.documents),l=Xi.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,l);rg(n,t,d.wa);let p=new uh(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function _T(n,e,t){return y(this,null,function*(){let r=z(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!pa(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Kl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&kh(r.remoteStore,i.targetId),dh(r,i.targetId)}).catch(cs))):(dh(r,i.targetId),yield Kl(r.localStore,i.targetId,!0))})}function yT(n,e){return y(this,null,function*(){let t=z(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),kh(t.remoteStore,r.targetId))})}function vT(n,e,t){return y(this,null,function*(){let r=CT(n);try{let i=yield function(a,u){let l=z(a),d=Pe.now(),p=u.reduce((R,x)=>R.add(x.key),J()),v,b;return l.persistence.runTransaction("Locally write mutations","readwrite",R=>{let x=Ut(),k=J();return l.cs.getEntries(R,p).next(M=>{x=M,x.forEach((H,Y)=>{Y.isValidDocument()||(k=k.add(H))})}).next(()=>l.localDocuments.getOverlayedDocuments(R,x)).next(M=>{v=M;let H=[];for(let Y of u){let X=Cw(Y,v.get(Y.key).overlayedDocument);X!=null&&H.push(new Tt(Y.key,X,gg(X.value.mapValue),dn.exists(!0)))}return l.mutationQueue.addMutationBatch(R,d,H,u)}).next(M=>{b=M;let H=M.applyToLocalDocumentSet(v,k);return l.documentOverlayCache.saveOverlays(R,M.batchId,H)})}).then(()=>({batchId:b.batchId,changes:Cg(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,l){let d=a.Ba[a.currentUser.toKey()];d||(d=new _e(te)),d=d.insert(u,l),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield hs(r,i.changes),yield ya(r.remoteStore)}catch(i){let s=Mh(i,"Failed to persist write");t.reject(s)}})}function e_(n,e){return y(this,null,function*(){let t=z(n);try{let r=yield Qw(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Na.get(s);a&&(ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ie(a.va):i.removedDocuments.size>0&&(ie(a.va),a.va=!1))}),yield hs(t,r,e)}catch(r){yield cs(r)}})}function ng(n,e,t){let r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let l=z(a);l.onlineState=u;let d=!1;l.queries.forEach((p,v)=>{for(let b of v.j_)b.Z_(u)&&(d=!0)}),d&&Fh(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function IT(n,e,t){return y(this,null,function*(){let r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let a=new _e(q.comparator);a=a.insert(s,at.newNoDocument(s,W.min()));let u=J().add(s),l=new qo(W.min(),new Map,new _e(te),a,u);yield e_(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),Lh(r)}else yield Kl(r.localStore,e,!1).then(()=>dh(r,e,t)).catch(cs)})}function ET(n,e){return y(this,null,function*(){let t=z(n),r=e.batch.batchId;try{let i=yield Kw(t.localStore,e);n_(t,r,null),t_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield hs(t,i)}catch(i){yield cs(i)}})}function wT(n,e,t){return y(this,null,function*(){let r=z(n);try{let i=yield function(a,u){let l=z(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return l.mutationQueue.lookupMutationBatch(d,u).next(v=>(ie(v!==null),p=v.keys(),l.mutationQueue.removeMutationBatch(d,v))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>l.localDocuments.getDocuments(d,p))})}(r.localStore,e);n_(r,e,t),t_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield hs(r,i)}catch(i){yield cs(i)}})}function t_(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function n_(n,e,t){let r=z(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function dh(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||r_(n,r)})}function r_(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(kh(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Lh(n))}function rg(n,e,t){for(let r of t)r instanceof ta?(n.La.addReference(r.key,e),TT(n,r)):r instanceof na?(U("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||r_(n,r.key)):G()}function TT(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(U("SyncEngine","New document in limbo: "+t),n.xa.add(r),Lh(n))}function Lh(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new q(fe.fromString(e)),r=n.qa.next();n.Na.set(r,new lh(t)),n.Oa=n.Oa.insert(t,r),zg(n.remoteStore,new Zi(It(Ph(t.path)),r,"TargetPurposeLimboResolution",dg.oe))}}function hs(n,e,t){return y(this,null,function*(){let r=z(n),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,l)=>{a.push(r.Ka(l,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let v=d?!d.fromCache:(p=t?.targetChanges.get(l.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(l.targetId,v?"current":"not-current")}if(d){i.push(d);let v=Gl.Wi(l.targetId,d);s.push(v)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(l,d){return y(this,null,function*(){let p=z(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>V.forEach(d,b=>V.forEach(b.$i,R=>p.persistence.referenceDelegate.addReference(v,b.targetId,R)).next(()=>V.forEach(b.Ui,R=>p.persistence.referenceDelegate.removeReference(v,b.targetId,R)))))}catch(v){if(!us(v))throw v;U("LocalStore","Failed to update sequence numbers: "+v)}for(let v of d){let b=v.targetId;if(!v.fromCache){let R=p.os.get(b),x=R.snapshotVersion,k=R.withLastLimboFreeSnapshotVersion(x);p.os=p.os.insert(b,k)}}})}(r.localStore,s))})}function bT(n,e){return y(this,null,function*(){let t=z(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());let r=yield $g(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(u=>{u.forEach(l=>{l.reject(new L(D.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield hs(t,r.hs)}})}function AT(n,e){let t=z(n),r=t.Na.get(e);if(r&&r.va)return J().add(r.key);{let i=J(),s=t.Ma.get(e);if(!s)return i;for(let a of s){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function i_(n){let e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=e_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=IT.bind(null,e),e.Ca.d_=dT.bind(null,e.eventManager),e.Ca.$a=fT.bind(null,e.eventManager),e}function CT(n){let e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ET.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wT.bind(null,e),e}var ig=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=ga(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return Hw(this.persistence,new Wl,t.initialUser,this.serializer)}Ga(t){return new ql($l.Zr,this.serializer)}Wa(t){return new Ql}terminate(){return y(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var ST=(()=>{class n{initialize(t,r){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>ng(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bT.bind(null,this.syncEngine),yield hT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new oh}()}createDatastore(t){let r=ga(t.databaseInfo.databaseId),i=function(a){return new Xl(a)}(t.databaseInfo);return function(a,u,l,d){return new th(a,u,l,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,a,u,l){return new rh(i,s,a,u,l)}(this.localStore,this.datastore,t.asyncQueue,r=>ng(this.syncEngine,r,0),function(){return Ko.D()?new Ko:new Jl}())}createSyncEngine(t,r){return function(s,a,u,l,d,p,v){let b=new hh(s,a,u,l,d,p);return v&&(b.Qa=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return y(this,null,function*(){var t,r;yield function(s){return y(this,null,function*(){let a=z(s);U("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield ls(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var ra=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ft("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var fh=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ce.UNAUTHENTICATED,this.clientId=xo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>y(this,null,function*(){U("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(U("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new yt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Mh(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Gu(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield $g(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function sg(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield RT(n);U("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Zm(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Zm(e.remoteStore,i)),n._onlineComponents=e})}function RT(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Gu(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===D.FAILED_PRECONDITION||i.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Pr("Error using user provided cache. Falling back to memory cache: "+t),yield Gu(n,new ig)}}else U("FirestoreClient","Using default OfflineComponentProvider"),yield Gu(n,new ig);return n._offlineComponents})}function s_(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),yield sg(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),yield sg(n,new ST))),n._onlineComponents})}function PT(n){return s_(n).then(e=>e.syncEngine)}function ph(n){return y(this,null,function*(){let e=yield s_(n),t=e.eventManager;return t.onListen=pT.bind(null,e.syncEngine),t.onUnlisten=_T.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=yT.bind(null,e.syncEngine),t})}function DT(n,e,t={}){let r=new yt;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,a,u,l,d){let p=new ra({next:b=>{p.Za(),a.enqueueAndForget(()=>Xg(s,v)),b.fromCache&&l.source==="server"?d.reject(new L(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(b)},error:b=>d.reject(b)}),v=new ea(u,p,{includeMetadataChanges:!0,_a:!0});return Yg(s,v)}(yield ph(n),n.asyncQueue,e,t,r)})),r.promise}function o_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var og=new Map;function a_(n,e,t){if(!t)throw new L(D.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function NT(n,e,t,r){if(e===!0&&r===!0)throw new L(D.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ag(n){if(!q.isDocumentKey(n))throw new L(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cg(n){if(q.isDocumentKey(n))throw new L(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function va(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":G()}function Mt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=va(n);throw new L(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var ia=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new L(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new L(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}NT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=o_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Br=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ia({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ia(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new zu;switch(r.type){case"firstParty":return new Qu(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=og.get(t);r&&(U("ComponentProvider","Removing Datastore"),og.delete(t),r.terminate())}(this),Promise.resolve()}};function c_(n,e,t,r={}){var i;let s=(n=Mt(n,Br))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Pr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let u,l;if(typeof r.mockUserToken=="string")u=r.mockUserToken,l=Ce.MOCK_USER;else{u=wf(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new L(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Ce(d)}n._authCredentials=new Wu(new Vo(u,l))}}var zn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ze=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},fn=class n extends zn{constructor(e,t,r){super(e,t,Ph(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ze(this.firestore,null,new q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function u_(n,e,...t){if(n=we(n),a_("collection","path",e),n instanceof Br){let r=fe.fromString(e,...t);return cg(r),new fn(n,null,r)}{if(!(n instanceof ze||n instanceof fn))throw new L(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(fe.fromString(e,...t));return cg(r),new fn(n.firestore,null,r)}}function Uh(n,e,...t){if(n=we(n),arguments.length===1&&(e=xo.newId()),a_("doc","path",e),n instanceof Br){let r=fe.fromString(e,...t);return ag(r),new ze(n,null,new q(r))}{if(!(n instanceof ze||n instanceof fn))throw new L(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(fe.fromString(e,...t));return ag(r),new ze(n.firestore,n instanceof fn?n.converter:null,new q(r))}}var sa=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Qo(this,"async_queue_retry"),this.Vu=()=>{let r=$u();r&&U("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=$u();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=$u();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new yt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return y(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!us(e))throw e;U("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw Ft("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=ih.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&G()}verifyOperationInProgress(){}wu(){return y(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function ug(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var _n=class extends Br{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new sa,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new sa(e),this._firestoreClient=void 0,yield e}})}};function l_(n,e){let t=typeof n=="object"?n:cr(),r=typeof n=="string"?n:e||"(default)",i=Ei(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Ef("firestore");s&&c_(i,...s)}return i}function Bh(n){if(n._terminated)throw new L(D.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||kT(n),n._firestoreClient}function kT(n){var e,t,r;let i=n._freezeSettings(),s=function(u,l,d,p){return new el(u,l,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,o_(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new fh(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){let l=u?._online.build();return{_offline:u?._offline.build(l),_online:l}}(n._componentsProvider))}var ns=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ue.fromBase64String(e))}catch(t){throw new L(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ue.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var qr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var rs=class{constructor(e){this._methodName=e}};var is=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return te(this._lat,e._lat)||te(this._long,e._long)}};var ss=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var VT=/^__.*__$/,mh=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Tt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gn(e,this.data,t,this.fieldTransforms)}},oa=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Tt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function h_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}var gh=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return ca(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(h_(this.Cu)&&VT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},_h=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ga(e)}Qu(e,t,r,i=!1){return new gh({Cu:e,methodName:t,qu:r,path:Xe.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function qh(n){let e=n._freezeSettings(),t=ga(n._databaseId);return new _h(n._databaseId,!!e.ignoreUndefinedProperties,t)}function xT(n,e,t,r,i,s={}){let a=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);jh("Data must be an object, but it was:",a,r);let u=d_(r,a),l,d;if(s.merge)l=new nt(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let v of s.mergeFields){let b=yh(e,v,t);if(!a.contains(b))throw new L(D.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);p_(p,b)||p.push(b)}l=new nt(p),d=a.fieldTransforms.filter(v=>l.covers(v.field))}else l=null,d=a.fieldTransforms;return new mh(new Ye(u),l,d)}var aa=class n extends rs{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function OT(n,e,t,r){let i=n.Qu(1,e,t);jh("Data must be an object, but it was:",i,r);let s=[],a=Ye.empty();Wn(r,(l,d)=>{let p=$h(e,l,t);d=we(d);let v=i.Nu(p);if(d instanceof aa)s.push(p);else{let b=ds(d,v);b!=null&&(s.push(p),a.set(p,b))}});let u=new nt(s);return new oa(a,u,i.fieldTransforms)}function MT(n,e,t,r,i,s){let a=n.Qu(1,e,t),u=[yh(e,r,t)],l=[i];if(s.length%2!=0)throw new L(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<s.length;b+=2)u.push(yh(e,s[b])),l.push(s[b+1]);let d=[],p=Ye.empty();for(let b=u.length-1;b>=0;--b)if(!p_(d,u[b])){let R=u[b],x=l[b];x=we(x);let k=a.Nu(R);if(x instanceof aa)d.push(R);else{let M=ds(x,k);M!=null&&(d.push(R),p.set(R,M))}}let v=new nt(d);return new oa(p,v,a.fieldTransforms)}function FT(n,e,t,r=!1){return ds(t,n.Qu(r?4:3,e))}function ds(n,e){if(f_(n=we(n)))return jh("Unsupported field value:",e,n),d_(n,e);if(n instanceof rs)return function(r,i){if(!h_(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let u of r){let l=ds(u,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=we(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ew(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Pe.fromDate(r);return{timestampValue:zo(i.serializer,s)}}if(r instanceof Pe){let s=new Pe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:zo(i.serializer,s)}}if(r instanceof is)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ns)return{bytesValue:Mg(i.serializer,r._byteString)};if(r instanceof ze){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Nh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ss)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw u.Bu("VectorValues must only contain numeric values.");return Dh(u.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${va(r)}`)}(n,e)}function d_(n,e){let t={};return fg(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wn(n,(r,i)=>{let s=ds(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function f_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pe||n instanceof is||n instanceof ns||n instanceof ze||n instanceof rs||n instanceof ss)}function jh(n,e,t){if(!f_(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=va(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function yh(n,e,t){if((e=we(e))instanceof qr)return e._internalPath;if(typeof e=="string")return $h(n,e);throw ca("Field path arguments must be of type string or ",n,!1,void 0,t)}var LT=new RegExp("[~\\*/\\[\\]]");function $h(n,e,t){if(e.search(LT)>=0)throw ca(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new qr(...e.split("."))._internalPath}catch{throw ca(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ca(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new L(D.INVALID_ARGUMENT,u+n+l)}function p_(n,e){return n.some(t=>t.isEqual(e))}var ua=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new vh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Gh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},vh=class extends ua{data(){return super.data()}};function Gh(n,e){return typeof e=="string"?$h(n,e):e instanceof qr?e._internalPath:e._delegate._internalPath}function m_(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var os=class{},Ih=class extends os{};function Kn(n,e,...t){let r=[];e instanceof os&&r.push(e),r=r.concat(t),function(s){let a=s.filter(l=>l instanceof Eh).length,u=s.filter(l=>l instanceof la).length;if(a>1||a>0&&u>0)throw new L(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var la=class n extends Ih{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return g_(e._query,t),new zn(e.firestore,e.converter,fl(e._query,t))}_parse(e){let t=qh(e.firestore);return function(s,a,u,l,d,p,v){let b;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new L(D.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){hg(v,p);let R=[];for(let x of v)R.push(lg(l,s,x));b={arrayValue:{values:R}}}else b=lg(l,s,v)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||hg(v,p),b=FT(u,a,v,p==="in"||p==="not-in");return Ie.create(d,p,b)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function zh(n,e,t){let r=e,i=Gh("where",n);return la._create(i,r,t)}var Eh=class n extends os{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ct.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,u=s.getFlattenedFilters();for(let l of u)g_(a,l),a=fl(a,l)}(e._query,t),new zn(e.firestore,e.converter,fl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function lg(n,e,t){if(typeof(t=we(t))=="string"){if(t==="")throw new L(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wg(e)&&t.indexOf("/")!==-1)throw new L(D.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(fe.fromString(t));if(!q.isDocumentKey(r))throw new L(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Om(n,new q(r))}if(t instanceof ze)return Om(n,t._key);throw new L(D.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${va(t)}.`)}function hg(n,e){if(!Array.isArray(n)||n.length===0)throw new L(D.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function g_(n,e){let t=function(i,s){for(let a of i)for(let u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new L(D.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(D.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var wh=class{convertValue(e,t="none"){switch(Bn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return de(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(pn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw G()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Wn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>de(a.doubleValue));return new ss(s)}convertGeoPoint(e){return new is(de(e.latitude),de(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Ah(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ji(e));default:return null}}convertTimestamp(e){let t=Lt(e);return new Pe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=fe.fromString(e);ie(jg(r));let i=new Lo(r.get(1),r.get(3)),s=new q(r.popFirst(5));return i.isEqual(t)||Ft(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function UT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Fn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},ha=class extends ua{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Rr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Gh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Rr=class extends ha{data(e={}){return super.data(e)}},da=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Rr(this._firestore,this._userDataWriter,r.key,r,new Fn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let l=new Rr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Fn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let l=new Rr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Fn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:BT(u.type),doc:l,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function BT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}var as=class extends wh{constructor(e){super(),this.firestore=e}convertBytes(e){return new ns(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,t)}};function Wh(n){n=Mt(n,zn);let e=Mt(n.firestore,_n),t=Bh(e),r=new as(e);return m_(n._query),DT(t,n._query).then(i=>new da(e,r,n,i))}function Hh(n,e,t,...r){n=Mt(n,ze);let i=Mt(n.firestore,_n),s=qh(i),a;return a=typeof(e=we(e))=="string"||e instanceof qr?MT(s,"updateDoc",n._key,e,t,r):OT(s,"updateDoc",n._key,e),y_(i,[a.toMutation(n._key,dn.exists(!0))])}function __(n,e){let t=Mt(n.firestore,_n),r=Uh(n),i=UT(n.converter,e);return y_(t,[xT(qh(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,dn.exists(!1))]).then(()=>r)}function Kh(n,...e){var t,r,i;n=we(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||ug(e[a])||(s=e[a],a++);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ug(e[a])){let v=e[a];e[a]=(t=v.next)===null||t===void 0?void 0:t.bind(v),e[a+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[a+2]=(i=v.complete)===null||i===void 0?void 0:i.bind(v)}let l,d,p;if(n instanceof ze)d=Mt(n.firestore,_n),p=Ph(n._key.path),l={next:v=>{e[a]&&e[a](qT(d,n,v))},error:e[a+1],complete:e[a+2]};else{let v=Mt(n,zn);d=Mt(v.firestore,_n),p=v._query;let b=new as(d);l={next:R=>{e[a]&&e[a](new da(d,b,v,R))},error:e[a+1],complete:e[a+2]},m_(n._query)}return function(b,R,x,k){let M=new ra(k),H=new ea(R,M,x);return b.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Yg(yield ph(b),H)})),()=>{M.Za(),b.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Xg(yield ph(b),H)}))}}(Bh(d),p,u,l)}function y_(n,e){return function(r,i){let s=new yt;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return vT(yield PT(r),i,s)})),s.promise}(Bh(n),e)}function qT(n,e,t){let r=t.docs.get(e._key),i=new as(n);return new ha(n,i,e._key,r,new Fn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){jr=i})(Zt),Xt(new et("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),u=new _n(new Hu(r.getProvider("auth-internal")),new Yu(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new L(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lo(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Te(Nm,"4.7.3",e),Te(Nm,"4.7.3","esm2017")})();var Ia=function(){return Ia=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ia.apply(this,arguments)};var GT={includeMetadataChanges:!1};function v_(n,e){return e===void 0&&(e=GT),new ui(function(t){var r=Kh(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function I_(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Ia(Ia({},r),(t={},t[e.idField]=n.id,t))}function E_(n){return v_(n,{includeMetadataChanges:!0}).pipe(li(function(e){return e.docs}))}function w_(n,e){return e===void 0&&(e={}),E_(n).pipe(li(function(t){return t.map(function(r){return I_(r,e)})}))}var Bt=class{constructor(e){return e}},T_="firestore",Qh=class{constructor(){return wi(T_)}};var Jh=new Ke("angularfire2.firestore-instances");function zT(n,e){let t=Bs(T_,n,e);return t&&new Bt(t)}function WT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Bt(r)}}var HT={provide:Qh,deps:[[new Ze,Jh]]},KT={provide:Bt,useFactory:zT,deps:[[new Ze,Jh],Dt]};function b_(n,...e){return Te("angularfire",Rn.full,"fst"),Zn([KT,HT,{provide:Jh,useFactory:WT(n),multi:!0,deps:[Kt,Tn,hr,Pn,[new Ze,Ni],[new Ze,lr],...e]}])}var fs=tt(w_,!0);var Ea=tt(__,!0);var qt=tt(u_,!0);var A_=tt(Uh,!0);var C_=tt(l_,!0);var yn=class n{constructor(e,t){this.firestore=e;this.auth=t}sendPaciente(e,t,r,i,s,a,u){console.log(e);let l=qt(this.firestore,"pacientes");Ea(l,{nombre:e,apellido:t,edad:r,dni:i,obrasocial:s,email:a,clave:u,perfil:"paciente"}).then(()=>{console.log("Paciente agregado con \xE9xito")}).catch(p=>{console.error("Error al agregar Paciente: ",p)})}sendAdmin(e,t,r,i,s,a){console.log(e);let u=qt(this.firestore,"admins");Ea(u,{nombre:e,apellido:t,edad:r,dni:i,email:s,clave:a,perfil:"admin"}).then(()=>{console.log("Admin agregado con \xE9xito")}).catch(d=>{console.error("Error al agregar Admin: ",d)})}sendEspecialista(e,t,r,i,s,a,u){console.log(e);let l=qt(this.firestore,"especialistas");Ea(l,{nombre:e,apellido:t,edad:r,dni:i,email:s,clave:a,especialista:u,perfil:"especialista"}).then(()=>{console.log("especialista agregado con \xE9xito")}).catch(p=>{console.error("Error al agregar especialista: ",p)})}getEspecialistas(e){let t=qt(this.firestore,e),r=Kn(t);return fs(r)}ingresarHorario(e){let t="juan@gmail.com",r=qt(this.firestore,"especialistas"),i=Kn(r,zh("email","==",t));Wh(i).then(s=>{if(s.empty)console.log("No se encontr\xF3 el especialista con ese email.");else{let u=s.docs[0].id,l=A_(this.firestore,"especialistas",u);Hh(l,{horario:e})}}).catch(s=>{console.error("Error al realizar la consulta:",s)})}static \u0275fac=function(t){return new(t||n)(Ht(Bt),Ht(Re))};static \u0275prov=lt({token:n,factory:n.\u0275fac,providedIn:"root"})};function QT(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"El nombre solo puede contener letras"),S(),Oe())}function JT(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"El nombre es requerido"),S(),Oe())}function YT(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"El apellido solo puede contener letras"),S(),Oe())}function XT(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"El apellido es requerido"),S(),Oe())}function ZT(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"Debe ser menor de 99"),S(),Oe())}function eb(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"La edad es requerida"),S(),Oe())}function tb(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"Debe contener solo n\xFAmeros"),S(),Oe())}function nb(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"No debe superar los 10 caracteres"),S(),Oe())}function rb(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"El DNI es requerido"),S(),Oe())}function ib(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"El correo electr\xF3nico es inv\xE1lido"),S(),Oe())}function sb(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"El correo electr\xF3nico es requerido"),S(),Oe())}function ob(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"La clave solo puede contener letras"),S(),Oe())}function ab(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"La clave es requerida"),S(),Oe())}function cb(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"La obra social solo puede contener letras"),S(),Oe())}function ub(n,e){n&1&&(xe(0),P(1,"small",32),N(2,"La obra social es requerida"),S(),Oe())}function lb(n,e){if(n&1&&(P(0,"div")(1,"div",5)(2,"label",33),N(3,"Obra Social:"),S(),ue(4,"input",34),ce(5,cb,3,0,"ng-container",20)(6,ub,3,0,"ng-container",20),S()()),n&2){let t,r,i=ne(2);F(5),B("ngIf",((t=i.form.get("obrasocial"))==null?null:t.hasError("pattern"))&&((t=i.form.get("obrasocial"))==null?null:t.touched)),F(),B("ngIf",((r=i.form.get("obrasocial"))==null?null:r.hasError("required"))&&((r=i.form.get("obrasocial"))==null?null:r.touched))}}function hb(n,e){if(n&1&&(P(0,"option"),N(1),S()),n&2){let t=e.$implicit;F(),it(" ",t," ")}}function db(n,e){if(n&1&&(P(0,"option"),N(1),S()),n&2){let t=e.$implicit;F(),it(" ",t," ")}}function fb(n,e){if(n&1){let t=Ee();P(0,"div",35)(1,"select",36),K("change",function(i){le(t);let s=ne(3);return he(s.changeDepartament(i))}),P(2,"option"),N(3,"--Select--"),S(),ce(4,db,2,1,"option",37),S()()}if(n&2){let t=ne(3);F(4),B("ngForOf",t.DepartamentList)}}function pb(n,e){if(n&1){let t=Ee();P(0,"button",40),K("click",function(){le(t);let i=ne(3);return he(i.addEspecialidad())}),N(1,"Agregar Especialidad"),S()}}function mb(n,e){if(n&1){let t=Ee();P(0,"div")(1,"label"),N(2,"Seleccione Especialidades:"),S(),P(3,"div",35)(4,"select",36),K("change",function(i){le(t);let s=ne(2);return he(s.changeDepartament(i))}),P(5,"option"),N(6,"--Select--"),S(),ce(7,hb,2,1,"option",37),S()(),ue(8,"br"),ce(9,fb,5,1,"div",38)(10,pb,2,0,"button",39),S()}if(n&2){let t=ne(2);F(7),B("ngForOf",t.DepartamentList),F(2),B("ngIf",t.otro),F(),B("ngIf",t.otro==!1)}}function gb(n,e){if(n&1&&(P(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),N(4),S(),P(5,"div",5)(6,"label",18),N(7,"Nombre:"),S(),ue(8,"input",19),ce(9,QT,3,0,"ng-container",20)(10,JT,3,0,"ng-container",20),S(),P(11,"div",5)(12,"label",21),N(13,"Apellido:"),S(),ue(14,"input",22),ce(15,YT,3,0,"ng-container",20)(16,XT,3,0,"ng-container",20),S(),P(17,"div",23)(18,"label",24),N(19,"Edad:"),S(),ue(20,"input",25),ce(21,ZT,3,0,"ng-container",20)(22,eb,3,0,"ng-container",20),S(),P(23,"div",23)(24,"label",26),N(25,"N\xFAmero de DNI:"),S(),ue(26,"input",27),ce(27,tb,3,0,"ng-container",20)(28,nb,3,0,"ng-container",20)(29,rb,3,0,"ng-container",20),S(),P(30,"div",5)(31,"label",28),N(32,"Correo Electr\xF3nico:"),S(),ue(33,"input",29),ce(34,ib,3,0,"ng-container",20)(35,sb,3,0,"ng-container",20),S(),P(36,"div",5)(37,"label",30),N(38,"Clave:"),S(),ue(39,"input",31),ce(40,ob,3,0,"ng-container",20)(41,ab,3,0,"ng-container",20),S(),ce(42,lb,7,2,"div",20)(43,mb,11,3,"div",20),S()()()),n&2){let t,r,i,s,a,u,l,d,p,v,b,R,x,k=ne();F(4),nr(k.role.value),F(5),B("ngIf",((t=k.form.get("nombre"))==null?null:t.hasError("pattern"))&&((t=k.form.get("nombre"))==null?null:t.touched)),F(),B("ngIf",((r=k.form.get("nombre"))==null?null:r.hasError("required"))&&((r=k.form.get("nombre"))==null?null:r.touched)),F(5),B("ngIf",((i=k.form.get("apellido"))==null?null:i.hasError("pattern"))&&((i=k.form.get("apellido"))==null?null:i.touched)),F(),B("ngIf",((s=k.form.get("apellido"))==null?null:s.hasError("required"))&&((s=k.form.get("apellido"))==null?null:s.touched)),F(5),B("ngIf",((a=k.form.get("edad"))==null?null:a.hasError("max"))&&((a=k.form.get("edad"))==null?null:a.touched)),F(),B("ngIf",((u=k.form.get("edad"))==null?null:u.hasError("required"))&&((u=k.form.get("edad"))==null?null:u.touched)),F(5),B("ngIf",((l=k.form.get("dni"))==null?null:l.hasError("pattern"))&&((l=k.form.get("dni"))==null?null:l.touched)),F(),B("ngIf",((d=k.form.get("dni"))==null?null:d.hasError("maxlength"))&&((d=k.form.get("dni"))==null?null:d.touched)),F(),B("ngIf",((p=k.form.get("dni"))==null?null:p.hasError("required"))&&((p=k.form.get("dni"))==null?null:p.touched)),F(5),B("ngIf",((v=k.form.get("mail"))==null?null:v.hasError("pattern"))&&((v=k.form.get("mail"))==null?null:v.touched)),F(),B("ngIf",((b=k.form.get("mail"))==null?null:b.hasError("required"))&&((b=k.form.get("mail"))==null?null:b.touched)),F(5),B("ngIf",((R=k.form.get("clave"))==null?null:R.hasError("pattern"))&&((R=k.form.get("clave"))==null?null:R.touched)),F(),B("ngIf",((x=k.form.get("clave"))==null?null:x.hasError("required"))&&((x=k.form.get("clave"))==null?null:x.touched)),F(),B("ngIf",k.role.value==="cliente"),F(),B("ngIf",k.role.value==="empleado")}}function _b(n,e){if(n&1&&(P(0,"div",41),N(1),S()),n&2){let t=ne();F(),nr(t.resultado)}}function yb(n,e){if(n&1&&(P(0,"div",42),N(1),S()),n&2){let t=ne();F(),nr(t.resultado)}}var wa=class n{constructor(e,t,r,i){this.auth=e;this.router=t;this.fb=r;this.sendUsers=i}email="";password="";mensagges="";loggedUser="";flagError=!1;flagSuccess=!1;msjError="";isLoading=!1;form;resultado="";rol="";otro=!1;ngOnInit(){this.form=new an({nombre:new Me("",[ot.required,ot.pattern("^[a-zA-Z]+$")]),apellido:new Me("",[ot.required,ot.pattern("^[a-zA-Z]+$")]),mail:new Me("",ot.email),clave:new Me("",ot.minLength(4)),dni:new Me("",[ot.pattern("^[0-9]+$"),ot.maxLength(10)]),role:new Me(""),edad:new Me(""),obrasocial:new Me(""),especialidad:new Me(""),especialidadOtro:new Me("")})}get especialidad(){return this.form.get("especialidad")}get especialidadOtro(){return this.form.get("especialidadOtro")}get nombre(){return this.form.get("nombre")}get role(){return this.form.get("role")}get apellido(){return this.form.get("apellido")}get edad(){return this.form.get("edad")}get mail(){return this.form.get("mail")}get clave(){return this.form.get("clave")}get repiteClave(){return this.form.get("repiteClave")}get dni(){return this.form.get("dni")}get obrasocial(){return this.form.get("obrasocial")}enviar(){this.form.valid?(console.log("Formulario enviado",this.form.value),this.sendUser(),this.form.reset(),this.resultado="El formulario Enviado",this.flagSuccess=!0,this.router.navigate(["/home"])):(this.flagError=!0,console.log("Error Formulario"),this.resultado="El formulario no es v\xE1lido, Completar los demas Campos",this.form.markAllAsTouched())}adminRegister=!1;especialistaRegister=!1;clienteRegister=!1;onRoleChange(e){let t=e.target.value;t==="admin"?(this.rol="admin",this.adminRegister=!0,this.clienteRegister=!1,this.especialistaRegister=!1):t==="cliente"?(this.rol="cliente",this.adminRegister=!1,this.clienteRegister=!0,this.especialistaRegister=!1):(this.adminRegister=!1,this.clienteRegister=!1,this.especialistaRegister=!0)}sendUser(){switch(Gp(this.auth,this.form.value.mail,this.form.value.clave).then(e=>{e.user.email!==null&&console.log("Usuario creado con \xE9xito:",e.user)}).catch(e=>{console.error("Error al crear el usuario:",e)}),this.rol){case"cliente":this.sendUsers.sendPaciente(this.form.value.nombre,this.form.value.apellido,this.form.value.edad,this.form.value.dni,this.form.value.obrasocial,this.form.value.mail,this.form.value.clave);break;case"admin":this.sendUsers.sendAdmin(this.form.value.nombre,this.form.value.apellido,this.form.value.edad,this.form.value.dni,this.form.value.mail,this.form.value.clave);break;default:this.sendUsers.sendEspecialista(this.form.value.nombre,this.form.value.apellido,this.form.value.edad,this.form.value.dni,this.form.value.mail,this.form.value.clave,this.especialidades),this.otro=!1,this.especialidades=[];break}}especialidades=[];addEspecialidad(){this.otro=!0}DepartamentList=["hola","chau"];changeDepartament(e){this.especialidades.push(e.target.value)}static \u0275fac=function(t){return new(t||n)(j(Re),j(sr),j(Cm),j(yn))};static \u0275cmp=me({type:n,selectors:[["app-register"]],standalone:!0,features:[ge],decls:27,vars:4,consts:[[1,"container","mt-5"],[1,"card"],[1,"card-body"],[1,"card-title","text-center"],["id","registerForm",3,"formGroup"],[1,"mb-3"],["for","role",1,"form-label"],["id","role","formControlName","role",1,"form-select",3,"change"],["value","","disabled","","selected",""],["value","admin"],["value","cliente"],["value","empleado"],["class","container mt-5",4,"ngIf"],["type","submit",1,"btn","btn-primary","w-100",3,"click"],[1,"mb-3","text-center"],["data-sitekey","YOUR_SITE_KEY",1,"g-recaptcha"],["class","alert alert-danger mt-3","role","alert",4,"ngIf"],["class","alert alert-success mt-3","role","alert",4,"ngIf"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre","required","",1,"form-control"],[4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido","formControlName","apellido","required","",1,"form-control"],[1,"mb-3","col-md-6"],["for","edad",1,"form-label"],["type","number","id","edad","formControlName","edad","required","",1,"form-control"],["for","dni",1,"form-label"],["type","text","id","dni","formControlName","dni","required","",1,"form-control"],["for","mail",1,"form-label"],["type","text","id","mail","formControlName","mail","required","",1,"form-control"],["for","clave",1,"form-label"],["type","text","id","clave","formControlName","clave","required","",1,"form-control"],[1,"text-danger"],["for","obrasocial",1,"form-label"],["type","text","id","obrasocial","formControlName","obrasocial",1,"form-control"],[1,"col-sm-10"],["name","Departamente",1,"form-control",3,"change"],[4,"ngFor","ngForOf"],["class","col-sm-10",4,"ngIf"],["type","button","class","btn btn-secondary mt-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-secondary","mt-2",3,"click"],["role","alert",1,"alert","alert-danger","mt-3"],["role","alert",1,"alert","alert-success","mt-3"]],template:function(t,r){t&1&&(P(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),N(4,"Registro"),S(),P(5,"form",4)(6,"div",5)(7,"label",6),N(8,"Elija su rol:"),S(),P(9,"select",7),K("change",function(s){return r.onRoleChange(s)}),P(10,"option",8),N(11,"Seleccione una opci\xF3n"),S(),P(12,"option",9),N(13,"Admin"),S(),P(14,"option",10),N(15,"Cliente"),S(),P(16,"option",11),N(17,"Especialista"),S()()(),ce(18,gb,44,16,"div",12),P(19,"button",13),K("click",function(){return r.enviar()}),N(20,"Enviar"),S(),P(21,"div",14)(22,"h1"),N(23,"a"),S(),ue(24,"div",15),S(),ce(25,_b,2,1,"div",16)(26,yb,2,1,"div",17),S()()()()),t&2&&(F(5),B("formGroup",r.form),F(13),B("ngIf",r.role),F(7),B("ngIf",r.flagError==!0),F(),B("ngIf",r.flagSuccess==!0))},dependencies:[dt,ir,Qt,un,Er,Eo,wo,cn,Nu,Io,vr,Ir,qi,Sm,ku,Vu]})};var Ta=class n{constructor(e,t){this.firestore=e;this.auth=t}getEspecialistas(){let e=qt(this.firestore,"especialistas"),t=Kn(e);return fs(t)}getEspecialidad(){let e=qt(this.firestore,"especialistas"),t=Kn(e);return fs(t)}static \u0275fac=function(t){return new(t||n)(Ht(Bt),Ht(Re))};static \u0275prov=lt({token:n,factory:n.\u0275fac,providedIn:"root"})};function Ib(n,e){if(n&1){let t=Ee();P(0,"div",12)(1,"div",13),K("click",function(){le(t);let i=ne().$implicit,s=ne(2);return he(s.seleccionarEspecialista(i))}),P(2,"div",14)(3,"p",15),N(4),S(),P(5,"span",16),N(6,"Disponible"),S()()()()}if(n&2){let t=e.$implicit;F(4),it("Especialidad: ",t,"")}}function Eb(n,e){if(n&1&&(P(0,"div",10),ce(1,Ib,7,1,"div",11),S()),n&2){let t=e.$implicit;F(),B("ngForOf",t.especialidad)}}function wb(n,e){if(n&1&&(P(0,"div")(1,"h3",8),N(2,"Especialistas Disponibles"),S(),P(3,"div",2),ce(4,Eb,2,1,"div",9),S()()),n&2){let t=ne();F(4),B("ngForOf",t.nombresFiltrados)}}function Tb(n,e){if(n&1){let t=Ee();P(0,"div",10)(1,"div",13),K("click",function(){let i=le(t).$implicit,s=ne(2);return he(s.seleccionarEspecialista(i))}),P(2,"div",14)(3,"h5",17),N(4),S(),P(5,"span",16),N(6,"Disponible"),S()()()()}if(n&2){let t=e.$implicit;F(4),nr(t.nombre)}}function bb(n,e){if(n&1&&(P(0,"div")(1,"h3",8),N(2,"Especialistas Disponiblesss"),S(),P(3,"div",2),ce(4,Tb,7,1,"div",9),S()()),n&2){let t=ne();F(4),B("ngForOf",t.nombresFiltrados)}}function Ab(n,e){if(n&1&&ue(0,"app-detalle-turno",18),n&2){let t=ne();B("especialistaSeleccionado",t.especialistaSeleccionado)("especialidadSeleccionado",t.especialidadSeleccionado)}}function Cb(n,e){n&1&&(P(0,"div")(1,"p",19),N(2,"No se encontraron resultados."),S()())}var ba=class n{constructor(e){this.turnos=e;this.dataEspecialidades(),this.dataNombres()}especialistaSeleccionado;especialidadSeleccionado;seleccionarEspecialista(e){this.especialistaSeleccionado=e.nombre,this.especialidadSeleccionado=e.especialidad}busqueda="";especialidadesArray=[];nombresEspecialistasArray=[];especialidadesFiltradas=[];nombresFiltrados=[];filtrar(){this.filtrarEspecialidades(),this.filtrarNombres()}filtrarEspecialidades(){let e=this.busqueda.toLowerCase();this.especialidadesFiltradas=this.especialidadesArray.filter(t=>String(t).toLowerCase().includes(e))}filtrarNombres(){let e=this.busqueda.toLowerCase();this.nombresFiltrados=this.nombresEspecialistasArray.filter(t=>String(t.nombre).toLowerCase().includes(e)||String(t.especialidad).toLowerCase().includes(e))}dataEspecialidades(){this.turnos.getEspecialistas().subscribe(e=>{this.especialidadesArray=e.map(t=>t.especialista),this.especialidadesFiltradas=[...this.especialidadesArray]})}dataNombres(){this.turnos.getEspecialistas().subscribe(e=>{this.nombresEspecialistasArray=e.map(t=>({nombre:t.nombre,especialidad:t.especialista})),this.nombresFiltrados=[...this.nombresEspecialistasArray]})}static \u0275fac=function(t){return new(t||n)(j(Ta))};static \u0275cmp=me({type:n,selectors:[["app-pacientes"]],standalone:!0,features:[ge],decls:11,vars:5,consts:[[1,"container","mt-5"],[1,"text-center","mb-4"],[1,"row","justify-content-center"],[1,"col-md-6"],[1,"input-group","mb-4"],["type","text","placeholder","Buscar especialista o especialidad","aria-label","Buscar",1,"form-control",3,"ngModelChange","input","ngModel"],[4,"ngIf"],[3,"especialistaSeleccionado","especialidadSeleccionado",4,"ngIf"],[1,"text-center","mb-3"],["class","col-md-4 mb-3",4,"ngFor","ngForOf"],[1,"col-md-4","mb-3"],["class","mb-3",4,"ngFor","ngForOf"],[1,"mb-3"],[1,"card","shadow-sm",3,"click"],[1,"card-body","text-center"],[1,"card-text"],[1,"badge","bg-success"],[1,"card-title"],[3,"especialistaSeleccionado","especialidadSeleccionado"],[1,"text-center"]],template:function(t,r){t&1&&(P(0,"div",0)(1,"h1",1),N(2,"Cl\xEDnica - B\xFAsqueda de Turnos"),S(),P(3,"div",2)(4,"div",3)(5,"div",4)(6,"input",5),gi("ngModelChange",function(s){return mi(r.busqueda,s)||(r.busqueda=s),s}),K("input",function(){return r.filtrar()}),S()()()(),ce(7,wb,5,1,"div",6)(8,bb,5,1,"div",6)(9,Ab,1,2,"app-detalle-turno",7)(10,Cb,3,0,"div",6),S()),t&2&&(F(6),pi("ngModel",r.busqueda),F(),B("ngIf",r.nombresFiltrados.length>0),F(),B("ngIf",r.nombresFiltrados.length>0),F(),B("ngIf",r.especialistaSeleccionado),F(),B("ngIf",r.especialidadesFiltradas.length===0&&r.nombresFiltrados.length===0))},dependencies:[dt,ir,Qt,un,cn,vr,Bi,_f],styles:['@charset "UTF-8";ul[_ngcontent-%COMP%]{list-style-type:none}.card[_ngcontent-%COMP%]{cursor:pointer;transition:transform .3s ease,box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{background-color:#28a745;color:#fff;transform:translateY(-5px);box-shadow:0 5px 15px #0003}']})};var Aa=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=me({type:n,selectors:[["app-especialistas"]],standalone:!0,features:[ge],decls:2,vars:0,template:function(t,r){t&1&&(P(0,"p"),N(1,"especialistas works!"),S())}})};var Ca=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=me({type:n,selectors:[["app-admin"]],standalone:!0,features:[ge],decls:2,vars:0,template:function(t,r){t&1&&(P(0,"p"),N(1,"admin works!"),S())}})};var Sa=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=me({type:n,selectors:[["app-paciente-perfil"]],standalone:!0,features:[ge],decls:2,vars:0,template:function(t,r){t&1&&(P(0,"p"),N(1,"paciente-perfil works!"),S())}})};function Sb(n,e){if(n&1&&(P(0,"option"),N(1),S()),n&2){let t=e.$implicit;F(),it(" ",t," ")}}var Ra=class n{constructor(e,t,r){this.authService=e;this.auth=t;this.userService=r;this.checkUser(),this.checkPerfil("especialistas")}DepartamentList=["9:00 a 18:00","7:00 a 15:000"];horario;user;getHorario;changeDepartament(e){this.horario=e.target.value}saveDataHorario(){this.userService.ingresarHorario(this.horario)}checkUser(){this.auth.onAuthStateChanged(e=>{e?this.user=e.email:console.log("No hay usuario autenticado.")})}checkPerfil(e){this.userService.getEspecialistas(e).subscribe(t=>{t.forEach(r=>{r.email==this.user&&(this.getHorario=r.horario)})})}static \u0275fac=function(t){return new(t||n)(j(ln),j(Re),j(yn))};static \u0275cmp=me({type:n,selectors:[["app-especialista-perfil"]],standalone:!0,features:[ge],decls:45,vars:3,consts:[[1,"container","mt-5"],[1,"text-center","mb-4"],[1,"row"],[1,"col-md-9"],[1,"tab-content"],["id","accountSettings",1,"tab-pane","fade","show","active"],[1,"mb-3"],["for","username",1,"form-label"],["type","text","id","username","placeholder","Nombre de usuario",1,"form-control"],["type","submit",1,"btn","btn-primary"],["for","email",1,"form-label"],["type","email","id","email","disabled","",1,"form-control",3,"placeholder"],["type","email","id","email","disabled","","placeholder","LUNES, MIERCOLES, VIERNES",1,"form-control"],[1,"col-sm-10"],["name","Departamente",1,"form-control",3,"change"],[4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(t,r){t&1&&(P(0,"div",0)(1,"h1",1),N(2,"Configuraci\xF3n"),S(),P(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h3"),N(8,"Cuenta"),S(),P(9,"form")(10,"div",6)(11,"label",7),N(12,"Nombre de usuario"),S(),ue(13,"input",8)(14,"br"),P(15,"button",9),N(16,"Guardar cambios"),S()(),P(17,"div",6)(18,"label",10),N(19,"Correo electr\xF3nico"),S(),ue(20,"input",11),S(),P(21,"div",6)(22,"label",10),N(23,"Dias Laborales"),S(),ue(24,"input",12),S(),P(25,"button",9),N(26,"Guardar cambios"),S()()(),ue(27,"br"),P(28,"div",5)(29,"h3"),N(30,"Establecer Horario"),S(),P(31,"form")(32,"div")(33,"div",13)(34,"label",10),N(35,"Ultimo Cambio:"),S(),ue(36,"input",11)(37,"br"),P(38,"select",14),K("change",function(s){return r.changeDepartament(s)}),P(39,"option"),N(40,"--Select--"),S(),ce(41,Sb,2,1,"option",15),S(),ue(42,"br"),S()(),P(43,"button",16),K("click",function(){return r.saveDataHorario()}),N(44,"Guardar cambios"),S()()()()()()()),t&2&&(F(20),cc("placeholder",r.user),F(16),cc("placeholder",r.getHorario),F(5),B("ngForOf",r.DepartamentList))},dependencies:[dt,ir,un,Er,Eo,wo,Ir,Ui]})};var Pa=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=me({type:n,selectors:[["app-admin-perfil"]],standalone:!0,features:[ge],decls:2,vars:0,template:function(t,r){t&1&&(P(0,"p"),N(1,"admin-perfil works!"),S())}})};var R_=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"login",component:bo},{path:"home",component:Co},{path:"register",component:wa},{path:"turnoPaciente",component:ba},{path:"turnosEspecialistas",component:Aa},{path:"turnoAdmin",component:Ca},{path:"perfilPaciente",component:Sa},{path:"perfilEspecialista",component:Ra},{path:"perfilAdmin",component:Pa},{path:"turnos",loadChildren:()=>import("./chunk-OAHRR2FS.js").then(n=>n.TurnosPacientesModule)}];var P_={apiKey:"AIzaSyBNyw5zD6mb_5fWXV0imZ-85iSdDwna2PM",authDomain:"tplabo4final.firebaseapp.com",projectId:"tplabo4final",storageBucket:"tplabo4final.firebasestorage.app",messagingSenderId:"300426428382",appId:"1:300426428382:web:d1e4746d9425388137a74f",measurementId:"G-QSV8236CMH"};var D_={providers:[hf({eventCoalescing:!0}),ff(),gf(R_),Wf(()=>Hf(P_)),$p(()=>zp()),b_(()=>C_())]};function Rb(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.navigateTo("turnoPaciente"))}),N(2,"turnoPaciente"),S()()}}function Pb(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.navigateTo("turnosEspecialistas"))}),N(2,"turnosEspecialistas"),S()()}}function Db(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.navigateTo("turnoAdmin"))}),N(2,"turnoAdmin"),S()()}}function Nb(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.navigateTo("perfilPaciente"))}),N(2,"perfilPaciente"),S()()}}function kb(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.navigateTo("perfilEspecialista"))}),N(2,"perfilEspecialista"),S()()}}function Vb(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.navigateTo("perfilAdmin"))}),N(2,"perfilAdmin"),S()()}}function xb(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.navigateTo("login"))}),N(2,"Iniciar Sesi\xF3n"),S()()}}function Ob(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.navigateTo("register"))}),N(2,"Registrarse"),S()()}}function Mb(n,e){if(n&1){let t=Ee();P(0,"li",7)(1,"a",8),K("click",function(){le(t);let i=ne();return he(i.signOut())}),N(2,"Cerrar sesi\xF3n"),S()()}}function Fb(n,e){if(n&1&&(P(0,"li",11),N(1),S()),n&2){let t=ne();F(),it(" ",t.user," ")}}var Da=class n{constructor(e,t,r,i){this.router=e;this.authService=t;this.auth=r;this.userService=i;this.checkUser(),this.checkPerfil("especialistas"),this.checkPerfil("admins"),this.checkPerfil("pacientes")}user;perfil;checkUser(){this.auth.onAuthStateChanged(e=>{e?(this.user=e.email,this.authService.setUser(e)):console.log("No hay usuario autenticado.")})}checkPerfil(e){this.userService.getEspecialistas(e).subscribe(t=>{t.forEach(r=>{r.email==this.user&&(this.perfil=r.perfil)})})}navigateTo(e){switch(e){case"home":this.router.navigate(["/home"]);break;case"login":this.router.navigate(["/login"]);break;case"register":this.router.navigate(["/register"]);break;case"turnoPaciente":this.router.navigate(["/turnoPaciente"]);break;case"turnosEspecialistas":this.router.navigate(["/turnosEspecialistas"]);break;case"turnoAdmin":this.router.navigate(["/turnoAdmin"]);break;case"perfilPaciente":this.router.navigate(["/perfilPaciente"]);break;case"perfilEspecialista":this.router.navigate(["/perfilEspecialista"]);break;case"perfilAdmin":this.router.navigate(["/perfilAdmin"]);break;default:console.log("Ruta no encontrada");break}}signOut(){return y(this,null,function*(){try{yield this.auth.signOut(),this.user="",this.perfil="",this.router.navigate(["/login"])}catch(e){console.error("Error signing out:",e)}})}static \u0275fac=function(t){return new(t||n)(j(sr),j(ln),j(Re),j(yn))};static \u0275cmp=me({type:n,selectors:[["app-header"]],standalone:!0,features:[ge],decls:21,vars:10,consts:[[1,"navbar","navbar-expand-lg","navbar-light","bg-light"],[1,"container"],[1,"navbar-brand",3,"click"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav","ms-auto"],[1,"nav-item"],[1,"nav-link",3,"click"],["class","nav-item",4,"ngIf"],["class","nav-item navbar-text",4,"ngIf"],[1,"nav-item","navbar-text"]],template:function(t,r){t&1&&(P(0,"nav",0)(1,"div",1)(2,"a",2),K("click",function(){return r.navigateTo("home")}),N(3,"Clinica Skenen"),S(),P(4,"button",3),ue(5,"span",4),S(),P(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),K("click",function(){return r.navigateTo("home")}),N(10,"Home"),S()(),ce(11,Rb,3,0,"li",9)(12,Pb,3,0,"li",9)(13,Db,3,0,"li",9)(14,Nb,3,0,"li",9)(15,kb,3,0,"li",9)(16,Vb,3,0,"li",9)(17,xb,3,0,"li",9)(18,Ob,3,0,"li",9)(19,Mb,3,0,"li",9)(20,Fb,2,1,"li",10),S()()()()),t&2&&(F(11),B("ngIf",r.perfil=="paciente"),F(),B("ngIf",r.perfil=="especialista"),F(),B("ngIf",r.perfil=="admin"),F(),B("ngIf",r.perfil=="paciente"),F(),B("ngIf",r.perfil=="especialista"),F(),B("ngIf",r.perfil=="admin"),F(),B("ngIf",!r.user),F(),B("ngIf",!r.user),F(),B("ngIf",r.user),F(),B("ngIf",r.user))},dependencies:[dt,Qt],styles:[".nav-item[_ngcontent-%COMP%], .navbar-brand[_ngcontent-%COMP%]{cursor:pointer}"]})};var Na=class n{title="tplabo4final";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=me({type:n,selectors:[["app-root"]],standalone:!0,features:[ge],decls:3,vars:0,consts:[[1,"contair"]],template:function(t,r){t&1&&(P(0,"div",0),ue(1,"app-header")(2,"router-outlet"),S())},dependencies:[mf,Da]})};pf(Na,D_).catch(n=>console.error(n));
